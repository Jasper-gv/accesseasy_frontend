import{_ as Ue,K as Be,y as Ne,r as s,c as ie,o as Re,u as $e,a as V,w as t,V as De,b as je,e as f,i as u,l as g,f as l,v as k,x,av as Le,F as B,B as N,g as y,h as n,k as ue,a3 as p,s as S,p as m,au as de,aH as Oe,H as R,X as re,j as me,$ as ce,a1 as pe,al as fe,aI as He}from"./index-B12n8wa1.js";const We={class:"d-flex align-center justify-space-between pa-4 mb-4",style:{"background-color":"#f8fafc","border-radius":"8px"}},_e={class:"d-flex align-center"},ze={class:"text-h5 font-weight-bold text-black mb-0"},Me={key:0,class:"loading-container d-flex flex-column align-center justify-center",style:{height:"70vh"}},qe={key:1,class:"clean-layout",style:{height:"70vh","overflow-y":"auto"}},Ke={class:"font-weight-medium"},Xe={style:{"max-width":"300px"}},Ge={__name:"salaryTemplateEdit",emits:["close"],setup(Je,{emit:ye}){const ve=Be.getTenantId(),F=Ne.getToken(),be=je(),ge=$e();s(null),s(null);const Ve=ye;s(!1);const T=s(!1),w=s(!1);s(!1);const $=s({number:""});s(!1),s(null);const xe=["Fixed","Percentage"],I=s([]),b=s(null),Ce=s(!1),Pe=s(!1),Ee=s(null),ke=s(!1),A=s(null);s("");const h=s(!1),C=s([]),Se=async()=>{try{const e=await(await fetch(`https://appv1.fieldseasy.com/directus/items/tenant?filter[tenantId][_eq]=${ve}`,{headers:{Authorization:`Bearer ${F}`}})).json();Ee.value=e.data[0],Ce.value=e.data.some(c=>c.pfAccount),ke.value=e.data.some(c=>c.shopAccount);const a=e.data.some(c=>(c.esiAccountNumber||[]).some(E=>E.state===A.value));Pe.value=a,a&&(b.value=A.value)}catch(d){console.error("Error fetching tenant data:",d)}},Fe=async d=>{var e;try{const c=await(await fetch(`https://appv1.fieldseasy.com/directus/items/tax?filter[_and][0][state][_icontains]=${encodeURIComponent(d)}`,{headers:{Authorization:`Bearer ${F}`}})).json();c.data&&c.data.length>0&&((e=c.data[0].stateTaxRules)!=null&&e.PT)?C.value=c.data[0].stateTaxRules.PT:C.value=[]}catch(a){console.error("Error fetching tax rules:",a),C.value=[]}};s([]),s([]),s(null),s(["Unskilled","Semi-Skilled","Skilled","Highly Skilled"]),s(null);const D=s(""),o=s({earning:[{label:"Basic Pay",value:100,unit:"Percentage"}],deduction:[],employerPF:{withinCTC:!1,value:1800,calculations:["Basic Pay"]},employerESI:{withinCTC:!1,value:3.25,calculations:["Basic Pay"]},employeePF:{value:1800,calculations:["Basic Pay"]},employeeESI:{value:3.25,calculations:["Basic Pay"]},includeEdli:!1}),Te=[{name:"Basic Pay",type:"Percentage"},{name:"HRA",type:"Percentage"},{name:"Dearness Allowance",type:"Percentage"},{name:"Special Allowance",type:"Percentage"},{name:"Travel Allowance",type:"Percentage"},{name:"Accomodation and Food",type:"Fixed"},{name:"Bonus and Incentives",type:"Fixed"},{name:"Cash Allowance",type:"Fixed"},{name:"Conveyance Allowance",type:"Fixed"},{name:"Children Education Allowance",type:"Fixed"},{name:"Distance Allowance",type:"Fixed"},{name:"Transport Allowance",type:"Fixed"}],P=ie(()=>o.value.earning.map(d=>({label:d.label,value:d.label,props:d.label==="Basic Pay"?{disabled:!0}:{}})));ie(()=>{const d=o.value.earning.map(e=>e.label);return Te.filter(e=>!d.includes(e.name))});const we=()=>{Ve("close"),be.push("/configuration/payroll-policy")},Ie=async d=>{var e,a,c,v,E,j,L,O,H,W,_,z,M,q,K,X,G,J,Q,Y,Z,ee,le,ae,te,oe,ne;T.value=!0;try{const U=(d==null?void 0:d.id)||d,Ae=["basicPay","earnings","deductions","employerContribution","allowances","deduction","professionalTax","LWF","employersContributions","employeeDeductions","configName","adminCharges","stateTaxes.state"].map(r=>`fields[]=${r}`).join("&")+`&filter[id][_eq]=${U}`,se=await fetch(`https://appv1.fieldseasy.com/directus/items/salarySetting?${Ae}`,{headers:{Authorization:`Bearer ${F}`}});if(!se.ok)throw new Error("Failed to fetch salary settings");const i=(await se.json()).data[0]||null;if(A.value=(e=i.stateTaxes)==null?void 0:e.state,(a=i==null?void 0:i.stateTaxes)!=null&&a.state&&await Fe(i.stateTaxes.state),!i)return null;const he=[{label:"Basic Pay",value:i.basicPay||100,unit:"Percentage"},...(i.earnings||[]).map(r=>({label:r.name,value:r.calculations==="Percentage"?r.Percentage:r.Fixed,unit:r.calculations==="Percentage"?"Percentage":"Fixed"}))];o.value.earning=he,o.value.deduction=(i.deductions||[]).map(r=>({label:r.name,value:r.amount,unit:"Fixed"})),o.value.employerPF.value=((v=(c=i.employersContributions)==null?void 0:c.EmployerPF)==null?void 0:v.selectedOption)||1800,o.value.employerPF.withinCTC=((j=(E=i.employersContributions)==null?void 0:E.EmployerPF)==null?void 0:j.withinCTC)||!1,o.value.employerPF.calculations=((H=(O=(L=i.employersContributions)==null?void 0:L.EmployerPF)==null?void 0:O.Calculations)==null?void 0:H.map(r=>r.name))||["Basic Pay"],o.value.employerESI.value=((_=(W=i.employersContributions)==null?void 0:W.EmployerESI)==null?void 0:_.selectedOption)||null,o.value.employerESI.withinCTC=((M=(z=i.employersContributions)==null?void 0:z.EmployerESI)==null?void 0:M.withinCTC)||!1,o.value.employerESI.calculations=((X=(K=(q=i.employersContributions)==null?void 0:q.EmployerESI)==null?void 0:K.Calculations)==null?void 0:X.map(r=>r.name))||["Basic Pay"],o.value.employeePF.value=((J=(G=i.employeeDeductions)==null?void 0:G.EmployeePF)==null?void 0:J.selectedOption)||1800,o.value.employeePF.calculations=((Z=(Y=(Q=i.employeeDeductions)==null?void 0:Q.EmployeePF)==null?void 0:Y.Calculations)==null?void 0:Z.map(r=>r.name))||["Basic Pay"],o.value.employeeESI.value=((le=(ee=i.employeeDeductions)==null?void 0:ee.EmployeeESI)==null?void 0:le.selectedOption)||null,o.value.employeeESI.calculations=((oe=(te=(ae=i.employeeDeductions)==null?void 0:ae.EmployeeESI)==null?void 0:te.Calculations)==null?void 0:oe.map(r=>r.name))||["Basic Pay"],o.value.includeEdli=((ne=i.adminCharges)==null?void 0:ne.enable)||!1,D.value=i.configName,b.value=i.stateTaxes.state,await Se()}catch(U){console.error("Error fetching salary settings:",U)}finally{T.value=!1}};return Re(async()=>{const d=ge.params.categoryData;await Ie(d)}),(d,e)=>(f(),V(De,{fluid:""},{default:t(()=>[u("div",We,[u("div",_e,[l(k,{icon:"mdi-arrow-left",variant:"text",color:"black",onClick:we,class:"mr-2"}),u("h2",ze," View "+x(D.value),1)])]),T.value?(f(),g("div",Me,[l(Le,{indeterminate:"",color:"primary",size:"64"}),e[19]||(e[19]=u("div",{class:"loading-text mt-4"},"Loading data...",-1))])):(f(),g("div",qe,[e[34]||(e[34]=u("div",{class:"section-header mb-4"},[u("div",{class:"section-indicator earning-indicator",style:{"background-color":"#22c55e"}}),u("h3",{class:"section-title",style:{color:"#166534"}},"Earning Components")],-1)),(f(!0),g(B,null,N(o.value.earning,(a,c)=>(f(),V(y,{key:a.id,class:"earning-row align-center mb-3 pb-2 border-bottom"},{default:t(()=>[l(n,{cols:"3"},{default:t(()=>[u("span",Ke,x(a.label),1)]),_:2},1024),l(n,{cols:"3"},{default:t(()=>[["Basic Pay","HRA","Dearness Allowance"].includes(a.label)?ue("",!0):(f(),V(p,{key:0,modelValue:a.unit,"onUpdate:modelValue":v=>a.unit=v,items:xe,label:"Type",variant:"outlined",density:"compact","hide-details":"","hide-no-data":"",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024),l(n,{cols:"3"},{default:t(()=>[l(S,{modelValue:a.value,"onUpdate:modelValue":v=>a.value=v,modelModifiers:{number:!0},type:"number",min:"0",label:"Value",variant:"outlined",density:"compact","hide-details":"",prefix:a.unit==="Percentage"?"%":"₹",placeholder:a.unit==="Percentage"?"Percentage":"Fixed",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,["modelValue","onUpdate:modelValue","prefix","placeholder"])]),_:2},1024),l(n,{cols:"3",class:"text-left"})]),_:2},1024))),128)),e[35]||(e[35]=u("div",{class:"section-header mb-4"},[u("div",{class:"section-indicator employer-indicator",style:{"background-color":"#3b82f6"}}),u("h3",{class:"section-title",style:{color:"#1e40af"}}," Employer Contribution ")],-1)),l(y,{class:"align-center mb-4 pb-2 border-bottom"},{default:t(()=>[l(n,{cols:"3"},{default:t(()=>e[20]||(e[20]=[m(" Employer PF ")])),_:1}),l(n,{cols:"3"},{default:t(()=>[l(p,{items:[{title:"12% No limit",value:12},{title:"12% ₹1800 limit",value:1800},{title:"NoValue",value:null}],modelValue:o.value.employerPF.value,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.employerPF.value=a),label:"Value",variant:"outlined",density:"compact","hide-details":"","item-title":"title","item-value":"value",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,["modelValue"])]),_:1}),l(n,{cols:"3"},{default:t(()=>[l(p,{items:P.value,modelValue:o.value.employerPF.calculations,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.employerPF.calculations=a),label:"Component",variant:"outlined",density:"compact","hide-details":"",multiple:"","item-title":"label","item-value":"value",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,["items","modelValue"])]),_:1}),l(n,{cols:"3"},{default:t(()=>[l(de,{modelValue:o.value.employerPF.withinCTC,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.employerPF.withinCTC=a),label:"Within CTC",density:"compact","hide-details":"",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),l(y,{class:"align-center mb-4 pb-2 border-bottom"},{default:t(()=>[l(n,{cols:"3"},{default:t(()=>e[21]||(e[21]=[m(" Employer ESI ")])),_:1}),l(n,{cols:"3"},{default:t(()=>[l(p,{items:[{title:"3.25%",value:3.25},{title:"NoValue",value:null}],modelValue:o.value.employerESI.value,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.employerESI.value=a),label:"Value",variant:"outlined",density:"compact","hide-details":"","item-title":"title","item-value":"value",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,["modelValue"])]),_:1}),l(n,{cols:"3"},{default:t(()=>[l(p,{items:P.value,modelValue:o.value.employerESI.calculations,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.employerESI.calculations=a),label:"Component",variant:"outlined",density:"compact","hide-details":"",multiple:"","item-title":"label","item-value":"value",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,["items","modelValue"])]),_:1}),l(n,{cols:"3"},{default:t(()=>[l(de,{modelValue:o.value.employerESI.withinCTC,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.employerESI.withinCTC=a),label:"Within CTC",density:"compact","hide-details":"",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),l(y,{class:"align-center mb-4 pb-2 border-bottom"},{default:t(()=>[l(n,{cols:"3"},{default:t(()=>e[22]||(e[22]=[m(" PF EDLI & Admin Charges ")])),_:1}),l(n,{cols:"3"},{default:t(()=>[l(Oe,{modelValue:o.value.includeEdli,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.includeEdli=a),"hide-details":"",density:"compact",color:"success",inset:"",readonly:""},null,8,["modelValue"])]),_:1}),o.value.includeEdli?(f(),V(n,{key:0,cols:"3"},{default:t(()=>[l(S,{variant:"outlined",density:"compact","hide-details":"",value:"1",suffix:"%",readonly:"",style:{"background-color":"#f5f5f5"}})]),_:1})):ue("",!0)]),_:1}),l(y,{class:"align-center mb-4 pb-2 border-bottom"},{default:t(()=>[l(n,{cols:"3"},{default:t(()=>e[23]||(e[23]=[m(" Labour Welfare Fund ")])),_:1}),l(n,{cols:"3",class:"d-flex align-center"},{default:t(()=>[l(R,{color:"grey-darken-1",class:"mr-2"},{default:t(()=>e[24]||(e[24]=[m("mdi-information-outline")])),_:1}),e[25]||(e[25]=u("span",{class:"text-grey-darken-1"},"Value based on state rules",-1))]),_:1}),l(n,{cols:"3"},{default:t(()=>[l(p,{modelValue:b.value,"onUpdate:modelValue":e[7]||(e[7]=a=>b.value=a),items:I.value,"item-title":"text","item-value":"value",label:"Select State",variant:"outlined",density:"compact",readonly:"",style:{"background-color":"#f5f5f5"},"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e[36]||(e[36]=u("div",{class:"section-header mb-4"},[u("div",{class:"section-indicator deduction-indicator",style:{"background-color":"#ef4444"}}),u("h3",{class:"section-title",style:{color:"#dc2626"}}," Deduction Components ")],-1)),l(y,{class:"align-center mb-4 pb-2 border-bottom"},{default:t(()=>[l(n,{cols:"3"},{default:t(()=>e[26]||(e[26]=[m(" Employee PF ")])),_:1}),l(n,{cols:"3"},{default:t(()=>[l(p,{items:[{title:"12% No limit",value:12},{title:"12% ₹1800 limit",value:1800},{title:"NoValue",value:null}],modelValue:o.value.employeePF.value,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.employeePF.value=a),label:"Value",variant:"outlined",density:"compact","hide-details":"","item-title":"title","item-value":"value",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,["modelValue"])]),_:1}),l(n,{cols:"3"},{default:t(()=>[l(p,{items:P.value,modelValue:o.value.employeePF.calculations,"onUpdate:modelValue":e[9]||(e[9]=a=>o.value.employeePF.calculations=a),label:"Component",variant:"outlined",density:"compact","hide-details":"",multiple:"","item-title":"label","item-value":"value",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,["items","modelValue"])]),_:1}),l(n,{cols:"3"})]),_:1}),l(y,{class:"align-center mb-4 pb-2 border-bottom"},{default:t(()=>[l(n,{cols:"3"},{default:t(()=>e[27]||(e[27]=[m(" Employee ESI ")])),_:1}),l(n,{cols:"3"},{default:t(()=>[l(p,{items:[{title:"0.75%",value:.75},{title:"NoValue",value:null}],modelValue:o.value.employeeESI.value,"onUpdate:modelValue":e[10]||(e[10]=a=>o.value.employeeESI.value=a),label:"Value",variant:"outlined",density:"compact","hide-details":"","item-title":"title","item-value":"value",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,["modelValue"])]),_:1}),l(n,{cols:"3"},{default:t(()=>[l(p,{items:P.value,modelValue:o.value.employeeESI.calculations,"onUpdate:modelValue":e[11]||(e[11]=a=>o.value.employeeESI.calculations=a),label:"Component",variant:"outlined",density:"compact","hide-details":"",multiple:"","item-title":"label","item-value":"value",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,["items","modelValue"])]),_:1}),l(n,{cols:"3"})]),_:1}),l(y,{class:"align-center mb-4 pb-2 border-bottom"},{default:t(()=>[l(n,{cols:"3"},{default:t(()=>e[28]||(e[28]=[m(" Labour Welfare Fund ")])),_:1}),l(n,{cols:"3",class:"d-flex align-center"},{default:t(()=>[l(R,{color:"grey-darken-1",class:"mr-2"},{default:t(()=>e[29]||(e[29]=[m("mdi-information-outline")])),_:1}),e[30]||(e[30]=u("span",{class:"text-grey-darken-1"},"Value based on state rules",-1))]),_:1}),l(n,{cols:"3"},{default:t(()=>[l(p,{modelValue:b.value,"onUpdate:modelValue":e[12]||(e[12]=a=>b.value=a),items:I.value,"item-title":"text","item-value":"value",label:"Select State",variant:"outlined",density:"compact",readonly:"",style:{"background-color":"#f5f5f5"},"hide-details":""},null,8,["modelValue","items"])]),_:1}),l(n,{cols:"3"})]),_:1}),l(y,{class:"align-center mb-4 pb-2 border-bottom"},{default:t(()=>[l(n,{cols:"3"},{default:t(()=>e[31]||(e[31]=[m(" Professional Tax ")])),_:1}),l(n,{cols:"3",class:"d-flex align-center"},{default:t(()=>[l(R,{color:"grey-darken-1",class:"mr-2"},{default:t(()=>e[32]||(e[32]=[m("mdi-information-outline")])),_:1}),e[33]||(e[33]=u("span",{class:"text-grey-darken-1"},"System Calculated",-1))]),_:1}),l(n,{cols:"3"},{default:t(()=>[l(p,{modelValue:b.value,"onUpdate:modelValue":e[13]||(e[13]=a=>b.value=a),items:I.value,"item-title":"text","item-value":"value",label:"Select State",variant:"outlined",density:"compact",readonly:"",style:{"background-color":"#f5f5f5"},"hide-details":""},null,8,["modelValue","items"])]),_:1}),l(n,{cols:"3"})]),_:1}),(f(!0),g(B,null,N(o.value.deduction,(a,c)=>(f(),V(y,{key:a.id,class:"align-center mb-3 border-bottom pb-2"},{default:t(()=>[l(n,{cols:"3"},{default:t(()=>[u("strong",null,x(a.label),1)]),_:2},1024),l(n,{cols:"3"}),l(n,{cols:"3"},{default:t(()=>[l(S,{modelValue:a.value,"onUpdate:modelValue":v=>a.value=v,modelModifiers:{number:!0},type:"number",min:"0",label:"Value",variant:"outlined",density:"compact","hide-details":"",prefix:"₹",placeholder:"Fixed",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(n,{cols:"3"})]),_:2},1024))),128))])),l(re,{modelValue:h.value,"onUpdate:modelValue":e[15]||(e[15]=a=>h.value=a),"max-width":"500px"},{default:t(()=>[l(me,null,{default:t(()=>[l(ce,{class:"text-h6 font-weight-bold"},{default:t(()=>e[37]||(e[37]=[m("Professional Tax Rules")])),_:1}),l(pe,null,{default:t(()=>[u("div",Xe,[u("ul",null,[(f(!0),g(B,null,N(C.value,a=>(f(),g("li",{key:a.salaryRange}," Salary Range: "+x(a.salaryRange)+" - Tax: ₹"+x(a.professionalTax),1))),128))])])]),_:1}),l(fe,{class:"justify-end"},{default:t(()=>[l(k,{variant:"text",onClick:e[14]||(e[14]=a=>h.value=!1)},{default:t(()=>e[38]||(e[38]=[m("Close")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(re,{modelValue:w.value,"onUpdate:modelValue":e[18]||(e[18]=a=>w.value=a),"max-width":"500px"},{default:t(()=>[l(me,null,{default:t(()=>[l(ce,{class:"text-h6 font-weight-bold"},{default:t(()=>e[39]||(e[39]=[m("Add ESI Account")])),_:1}),l(pe,null,{default:t(()=>[l(S,{modelValue:$.value.number,"onUpdate:modelValue":e[16]||(e[16]=a=>$.value.number=a),label:"ESI Number",variant:"outlined",readonly:"",style:{"background-color":"#f5f5f5"}},null,8,["modelValue"])]),_:1}),l(fe,{class:"justify-end"},{default:t(()=>[l(k,{variant:"text",onClick:e[17]||(e[17]=a=>w.value=!1),disabled:""},{default:t(()=>e[40]||(e[40]=[m("Cancel")])),_:1}),l(k,{color:"green",disabled:""},{default:t(()=>e[41]||(e[41]=[m("Save")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(He)]),_:1}))}},el=Ue(Ge,[["__scopeId","data-v-24953a0f"]]);export{el as default};
