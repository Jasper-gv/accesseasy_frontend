import{_ as ca,r as i,K as ce,y as ue,L as ua,c as ve,M as va,o as ma,E as Ie,l as b,i as r,f as t,w as l,N as pa,P as fa,X as Se,Y as Ve,b as ga,e as p,S as ya,Q as ba,R as wa,T as ha,U as me,p as c,x as v,W as Ca,Z as w,j as k,$ as X,H as x,a0 as Y,a1 as z,a2 as xa,s as Na,a3 as _e,k as Ee,q as Z,a4 as Aa,a5 as La,F as $e,B as Te,a6 as ka,g as Ia,h as G,a7 as Sa,a as pe,a8 as Va,a9 as _a,aa as Fe,ab as R,ac as Ea,ad as $a}from"./index-B12n8wa1.js";const Ta={class:"card-management-container"},Fa={class:"main-content full-width"},Pa={key:0},Da={key:1},Ra={key:2},Ua={key:3},Ba={class:"add-card-actions d-flex justify-end"},qa={class:"import-steps"},Ma={key:0,class:"upload-section"},ja={class:"text-center pa-4"},za={key:0,class:"mt-6"},Ha={key:1,class:"preview-section"},Oa={class:"text-caption text-medium-emphasis"},Qa={class:"preview-table-container"},Ka={class:"ml-1"},Wa={class:"preview-actions mt-4"},Ja={key:2,class:"import-section"},Xa={class:"text-caption"},Ya={class:"progress-section mb-6"},Za={class:"text-caption text-center"},Ga={class:"text-h6"},es={class:"text-h6"},as={class:"text-h6"},ss={class:"text-h6"},ts={class:"import-log mt-6"},ls={class:"import-actions mt-4"},rs={class:"d-flex align-center"},os={class:"d-flex align-center"},ns={__name:"importCardDetails",setup(ds){ga();const ee=i(!1),F=i(null),h=i(""),E=i(1),H=i(25),fe=i(0),I=i([]),ge=i([]),U=ce.getTenantId(),$=ue.getToken(),B=i(!1),C=i(1),q=i(null),M=i(""),S=i([]),N=i({current:0,total:0,percentage:0,completed:!1}),f=i({success:0,failed:0,duplicate:0,total:0}),V=i([]),ae=i(""),A=i(!1),_=i(null),j=i(!1),P=i(!1),se=i(null),O=i(!1),Q=i([]),te=i(!1),D=i(null),g=ua({cardNumber:"",type:"rfid"}),Pe=[a=>!!a||"Card number is required",a=>a&&a.length>0||"Card number is required"],De=[a=>!!a||"Card type is required"],Re=[{title:"RFID",value:"rfid"},{title:"Tag",value:"tag"}],le=i(!1),re=i(!1),ye=i(""),be=i(""),we=ve(()=>[{key:"rfidCard",label:"RFID Card",sortable:!0,width:"150px"},{key:"type",label:"Type",sortable:!0,width:"100px"},{key:"cardAccess",label:"Card Access",sortable:!0,width:"120px"}]),Ue=ve(()=>S.value.some(a=>a.valid)),oe=ve(()=>ne.value.map(a=>({...a,rfidCard:a.rfidCard||"N/A",type:a.type||"N/A",cardAccess:a.cardAccess??!1,cardAccessLevelArray:a.cardAccessLevelArray||"N/A",cardAccessLevelHex:a.cardAccessLevelHex||"N/A"}))),ne=i([]),Be=a=>{switch(a==null?void 0:a.toLowerCase()){case"rfid":return"primary";case"tag":return"info";default:return"grey"}},de=a=>{ye.value=a,le.value=!0},K=a=>{be.value=a,re.value=!0},qe=async()=>{if(!(!$||!U)){te.value=!0;try{const a=new URLSearchParams;a.append("fields[]","id"),a.append("fields[]","accessLevelNumber"),a.append("fields[]","accessLevelName"),a.append("fields[]","accessType"),a.append("fields[]","tenant.tenantId"),a.append("filter[_and][0][_and][0][tenant][tenantId][_eq]",U);const e=await fetch(`https://appv1.fieldseasy.com/directus/items/accesslevels?${a.toString()}`,{headers:{Authorization:`Bearer ${$}`}});if(!e.ok)throw new Error("Failed to load access levels");const s=await e.json();Q.value=(s.data||[]).map(o=>({title:`${o.accessLevelNumber} - ${o.accessLevelName}`,value:o.accessLevelNumber,name:o.accessLevelName,id:o.id})).sort((o,n)=>o.value-n.value)}catch(a){console.error("Error fetching access levels:",a),K("Failed to load access levels"),Q.value=[]}finally{te.value=!1}}},Me=async()=>{var a,e,s;try{if(!$||!U)throw new Error("Authentication required or tenant not found");const o=he();o["aggregate[count]"]="id";const n=Ce(o),m=await fetch(`https://appv1.fieldseasy.com/directus/items/cardManagement?${n}`,{headers:{Authorization:`Bearer ${$}`,"Content-Type":"application/json"}});if(!m.ok)throw new Error(`HTTP error! status: ${m.status}`);const u=await m.json();fe.value=((s=(e=(a=u==null?void 0:u.data)==null?void 0:a[0])==null?void 0:e.count)==null?void 0:s.id)||0}catch(o){console.error("Error fetching aggregate count:",o),F.value="Failed to load card count"}},he=()=>{const a={"filter[_and][0][_and][0][tenant][tenantId][_eq]":U};return h.value&&(isNaN(h.value)?(a["filter[_or][0][type][_icontains]"]=h.value,a["filter[_or][1][cardAccessLevelArray][_icontains]"]=h.value):(a["filter[_or][0][rfidCard][_eq]"]=h.value,a["filter[_or][1][cardAccessLevelArray][_icontains]"]=h.value)),a},Ce=a=>{var o;const e=new URLSearchParams;return["id","tenant.tenantId","cardAccessLevelArray","cardAccessLevelHex","rfidCard","type","cardAccess"].forEach(n=>e.append("fields[]",n)),Object.keys(a).forEach(n=>{Array.isArray(a[n])?a[n].forEach(m=>e.append(n,m)):e.append(n,a[n])}),e.append("sort",((o=I.value[0])==null?void 0:o.key)||"rfidCard"),e.append("page",E.value),e.append("limit",H.value),e.toString()},L=async()=>{try{ee.value=!0,F.value=null,await Me();const a=Ce(he()),e=await fetch(`https://appv1.fieldseasy.com/directus/items/cardManagement?${a}`,{headers:{Authorization:`Bearer ${$}`}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const s=await e.json();ne.value=s.data}catch(a){console.error("Error fetching card data:",a),F.value=a.message||"Failed to load card data"}finally{ee.value=!1}},je=async()=>{var a,e;if(O.value){P.value=!0;try{const s=await fetch(`https://appv1.fieldseasy.com/directus/items/cardManagement?filter[rfidCard][_eq]=${g.cardNumber}`,{headers:{Authorization:`Bearer ${$}`}}),{data:o}=await s.json();if(o!=null&&o.length)throw new Error("Card already exists");let n=0;if(D.value!==null&&D.value!==void 0){const d=Q.value.find(y=>y.value===D.value);d&&(n=d.value)}const m={rfidCard:g.cardNumber,type:g.type,cardAccess:!0,accessLevelsId:n,cardAccessLevelArray:`${g.cardNumber}:1:${n}`,cardAccessLevelHex:Fe(g.cardNumber,!0,n),tenant:U},u=await fetch("https://appv1.fieldseasy.com/directus/items/cardManagement",{method:"POST",headers:{Authorization:`Bearer ${$}`,"Content-Type":"application/json"},body:JSON.stringify(m)});if(!u.ok){const d=await u.json();throw new Error(((e=(a=d.errors)==null?void 0:a[0])==null?void 0:e.message)||"Failed to create card")}de(`Card "${g.cardNumber}" added successfully!`),ie(),L()}catch(s){K(s.message||"Failed to add card")}finally{P.value=!1}}},ie=()=>{j.value=!1,ze()},ze=()=>{g.cardNumber="",g.type="rfid",D.value=null,se.value&&se.value.reset()},xe=va.debounce(()=>{E.value=1,L()},300),He=()=>{h.value="",E.value=1,L()},Oe=a=>{var e;I.value=[{key:a,order:((e=I.value[0])==null?void 0:e.order)||"asc"}]},Qe=a=>{var e;I.value=[{key:((e=I.value[0])==null?void 0:e.key)||"",order:a}]},Ke=({field:a,direction:e})=>{I.value=[{key:a,order:e}],L()},We=a=>{E.value=a,L()},Je=a=>{H.value=a,E.value=1,L()},Xe=()=>{const a=[["Card Number","Access Level Number","Access Level Name"],["1234567890","1","Main Entrance"],["0987654321","2","Staff Area"],["1122334455","3","Admin Section"]],e=R.aoa_to_sheet(a),s=[{wch:15},{wch:20},{wch:25}];e["!cols"]=s;const o=R.decode_range(e["!ref"]);for(let m=o.s.c;m<=o.e.c;++m){const u=R.encode_cell({r:0,c:m});e[u]&&(e[u].s={font:{bold:!0},fill:{fgColor:{rgb:"D3D3D3"}}})}const n=R.book_new();R.book_append_sheet(n,e,"Card Import Template"),Ea(n,"card-import-template.xlsx")},Ye=async a=>{if(M.value="",!a)return;if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(a.type)){M.value="Please select a valid Excel file (.xlsx or .xls)";return}try{await Ze(a),C.value=2}catch(s){M.value="Error reading file: "+s.message}},Ze=a=>new Promise((e,s)=>{const o=new FileReader;o.onload=n=>{try{const m=new Uint8Array(n.target.result),u=$a(m,{type:"array"}),d=u.SheetNames[0],y=u.Sheets[d],T=R.sheet_to_json(y,{header:1});Ge(T),e()}catch(m){s(m)}},o.onerror=()=>s(new Error("Failed to read file")),o.readAsArrayBuffer(a)}),Ge=a=>{var u;S.value=[];const e=((u=a[0])==null?void 0:u.map(d=>d==null?void 0:d.toString().toLowerCase().trim()))||[],s=e.findIndex(d=>d.includes("card")&&d.includes("number")),o=e.findIndex(d=>d.includes("access")&&d.includes("level")&&d.includes("number")),n=e.findIndex(d=>d.includes("access")&&d.includes("level")&&d.includes("name")),m=s!==-1?1:0;for(let d=m;d<a.length;d++){const y=a[d],T=s!==-1?String(y[s]||"").trim():String(y[0]||"").trim(),W=o!==-1?String(y[o]||"").trim():"",J=n!==-1?String(y[n]||"").trim():"";T&&S.value.push({cardNumber:T,accessLevelNumber:W||null,accessLevelName:J||null,type:"rfid",valid:!0,rowIndex:d+1,error:null})}},ea=()=>{if(!q.value)return;if(S.value.filter(e=>e.valid).length===0){K("No card numbers found in the file");return}C.value=3,Ne()},Ne=()=>{const a=S.value.filter(e=>e.valid);if(a.length===0){K("No valid cards to import");return}C.value=3,f.value={success:0,failed:0,duplicate:0,total:a.length},N.value={current:0,total:a.length,percentage:0,completed:!1},V.value=[],A.value=!0,aa(a)},aa=async a=>{_.value=new AbortController;const e=_.value.signal;f.value={success:0,failed:0,duplicate:0,total:a.length};for(let s=0;s<a.length&&!e.aborted;s++){const o=a[s];ae.value=o.cardNumber;try{await ta(o),f.value.success++,V.value.unshift({type:"success",message:`Successfully imported card: ${o.cardNumber}`})}catch(n){n.message.includes("already exists")?(f.value.duplicate++,V.value.unshift({type:"warning",message:`Card already exists: ${o.cardNumber}`})):(f.value.failed++,V.value.unshift({type:"error",message:`Failed ${o.cardNumber}: ${n.message}`}))}N.value.current=s+1,N.value.percentage=(s+1)/a.length*100,await new Promise(n=>setTimeout(n,100))}N.value.completed=!0,A.value=!1,V.value.unshift({type:"info",message:`Import finished â€“ ${f.value.success} success, ${f.value.failed} failed, ${f.value.duplicate} duplicates`})},sa=async a=>{var e;if(a.accessLevelName)try{const s=ue.getToken(),o=ce.getTenantId(),n=new URLSearchParams({"filter[_and][0][_and][0][tenant][tenantId][_eq]":o,"filter[_and][0][_and][1][accessLevelName][_icontains]":a.accessLevelName,"fields[]":"id,accessLevelNumber,accessLevelName"}),m=await fetch(`https://appv1.fieldseasy.com/directus/items/accesslevels?${n}`,{headers:{Authorization:`Bearer ${s}`},signal:(e=_.value)==null?void 0:e.signal});if(!m.ok)throw new Error(`Failed to fetch access level: ${m.status}`);const{data:u}=await m.json();if(!u||u.length===0)throw new Error(`Access level not found: "${a.accessLevelName}"`);const d=u[0];return{accessLevelsId:d.accessLevelNumber,accessLevelName:d.accessLevelName}}catch(s){throw new Error(`Access level lookup failed: ${s.message}`)}if(a.accessLevelNumber){const s=parseInt(a.accessLevelNumber);if(isNaN(s))throw new Error(`Invalid access level number: "${a.accessLevelNumber}"`);return{accessLevelsId:s,accessLevelName:null}}return{accessLevelsId:0,accessLevelName:null}},ta=async a=>{var T,W,J,ke;const e=ue.getToken(),s=ce.getTenantId();if(!e||!s)throw new Error("Authentication required");const o=await fetch(`https://appv1.fieldseasy.com/directus/items/cardManagement?filter[rfidCard][_eq]=${a.cardNumber}`,{headers:{Authorization:`Bearer ${e}`},signal:(T=_.value)==null?void 0:T.signal});if(!o.ok)throw new Error("Failed to check card existence");const{data:n}=await o.json();if(n!=null&&n.length)throw new Error("Card already exists");const u=(await sa(a)).accessLevelsId,d={rfidCard:a.cardNumber,type:a.type,cardAccess:!0,accessLevelsId:u,cardAccessLevelArray:`${a.cardNumber}:1:${u}`,cardAccessLevelHex:Fe(a.cardNumber,!0,u),tenant:s},y=await fetch("https://appv1.fieldseasy.com/directus/items/cardManagement",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(d),signal:(W=_.value)==null?void 0:W.signal});if(!y.ok){const ia=await y.json();throw new Error(((ke=(J=ia.errors)==null?void 0:J[0])==null?void 0:ke.message)||"Failed to create card")}return y.json()},Ae=()=>{_.value&&_.value.abort(),A.value=!1,V.value.unshift({type:"warning",message:"Import cancelled by user"})},la=()=>{const a=f.value.success;B.value=!1,Le(),L(),a>0?de(`Import completed! ${a} cards imported.`):de("Import completed!")},ra=()=>{A.value&&!confirm("Import in progress. Cancel?")||(A.value&&Ae(),B.value=!1,Le())},Le=()=>{C.value=1,q.value=null,M.value="",S.value=[],N.value={current:0,total:0,percentage:0,completed:!1},f.value={success:0,failed:0,duplicate:0,total:0},V.value=[],ae.value="",A.value=!1,_.value=null},oa=a=>`log-${a}`,na=a=>({success:"success",error:"error",warning:"warning",info:"info"})[a]||"grey",da=a=>({success:"mdi-check-circle",error:"mdi-alert-circle",warning:"mdi-alert",info:"mdi-information"})[a]||"mdi-circle";return ma(async()=>await L()),Ie(j,a=>{a&&qe()}),Ie(h,()=>xe()),(a,e)=>(p(),b("div",Ta,[r("div",Fa,[t(fa,{searchQuery:h.value,"onUpdate:searchQuery":[e[5]||(e[5]=s=>h.value=s),pa(xe)],showSearch:!0,searchPlaceholder:"Search Card Details",isEmpty:oe.value.length===0&&!h.value,hasError:F.value},{"toolbar-actions":l(()=>[t(w,{variant:"primary",onClick:e[0]||(e[0]=s=>j.value=!0),"prepend-icon":"mdi-plus",class:"add-card-btn mr-2"},{default:l(()=>e[17]||(e[17]=[c(" Add Card ")])),_:1}),t(w,{variant:"primary",onClick:e[1]||(e[1]=s=>B.value=!0),"prepend-icon":"mdi-file-import",class:"import-btn"},{default:l(()=>e[18]||(e[18]=[c(" Import Cards ")])),_:1})]),pagination:l(()=>[t(Ca,{page:E.value,"onUpdate:page":[e[3]||(e[3]=s=>E.value=s),We],itemsPerPage:H.value,"onUpdate:itemsPerPage":[e[4]||(e[4]=s=>H.value=s),Je],"total-items":fe.value},null,8,["page","itemsPerPage","total-items"])]),default:l(()=>{var s,o;return[ee.value?(p(),b("div",Pa,[t(ya,{variant:"table-body-only",rows:ne.value.length||10,columns:we.value.length},null,8,["rows","columns"])])):F.value?(p(),b("div",Da,[t(ba,{title:"Unable to load card details",message:F.value,onRetry:L},null,8,["message"])])):oe.value.length===0?(p(),b("div",Ra,[t(wa,{title:"No card details found",message:"Try adjusting your filters or search term",primaryAction:{text:"Clear Filters"},onPrimaryAction:He})])):(p(),b("div",Ua,[t(ha,{items:oe.value,columns:we.value,selectedItems:ge.value,showSelection:!1,sortBy:((s=I.value[0])==null?void 0:s.key)||"",sortDirection:((o=I.value[0])==null?void 0:o.order)||"asc",itemKey:"id",rowClickable:!0,"onUpdate:selectedItems":e[2]||(e[2]=n=>ge.value=n),"onUpdate:sortBy":Oe,"onUpdate:sortDirection":Qe,onRowClick:a.handleRowClick,onSort:Ke},{"cell-rfidCard":l(({item:n})=>[r("span",null,v(n.rfidCard||"N/A"),1)]),"cell-type":l(({item:n})=>[t(me,{color:Be(n.type),size:"small",label:"",variant:"tonal"},{default:l(()=>[c(v(n.type),1)]),_:2},1032,["color"])]),"cell-cardAccess":l(({item:n})=>[t(me,{color:n.cardAccess?"success":"error",size:"small",label:""},{default:l(()=>[c(v(n.cardAccess?"Enable":"Disable"),1)]),_:2},1032,["color"])]),_:1},8,["items","columns","selectedItems","sortBy","sortDirection","onRowClick"])]))]}),_:1},8,["searchQuery","isEmpty","hasError","onUpdate:searchQuery"])]),t(Se,{modelValue:j.value,"onUpdate:modelValue":e[10]||(e[10]=s=>j.value=s),"max-width":"600px",persistent:""},{default:l(()=>[t(k,{class:"add-card-dialog"},{default:l(()=>[t(X,{class:"d-flex align-center"},{default:l(()=>[t(x,{class:"mr-2"},{default:l(()=>e[19]||(e[19]=[c("mdi-plus")])),_:1}),e[21]||(e[21]=c(" Add New Card ")),t(Y),t(w,{icon:"",onClick:ie,disabled:P.value,variant:"text"},{default:l(()=>[t(x,null,{default:l(()=>e[20]||(e[20]=[c("mdi-close")])),_:1})]),_:1},8,["disabled"])]),_:1}),t(z,{class:"pa-6"},{default:l(()=>[t(xa,{ref_key:"addCardForm",ref:se,modelValue:O.value,"onUpdate:modelValue":e[9]||(e[9]=s=>O.value=s)},{default:l(()=>[t(Na,{modelValue:g.cardNumber,"onUpdate:modelValue":e[6]||(e[6]=s=>g.cardNumber=s),label:"Card Number *",variant:"outlined",rules:Pe,required:"",class:"mb-4"},null,8,["modelValue"]),t(_e,{modelValue:D.value,"onUpdate:modelValue":e[7]||(e[7]=s=>D.value=s),items:Q.value,label:"Access Level","item-title":"title","item-value":"value",variant:"outlined",loading:te.value,clearable:"",placeholder:"Select access level (optional)",class:"mb-4"},null,8,["modelValue","items","loading"]),t(_e,{modelValue:g.type,"onUpdate:modelValue":e[8]||(e[8]=s=>g.type=s),label:"Card Type *",items:Re,variant:"outlined",rules:De,required:"",class:"mb-6"},null,8,["modelValue"]),r("div",Ba,[t(w,{variant:"outlined",onClick:ie,class:"mr-2",disabled:P.value},{default:l(()=>e[22]||(e[22]=[c(" CANCEL ")])),_:1},8,["disabled"]),t(w,{color:"primary",onClick:je,disabled:!O.value||P.value,loading:P.value,"prepend-icon":"mdi-content-save"},{default:l(()=>e[23]||(e[23]=[c(" SAVE CARD ")])),_:1},8,["disabled","loading"])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Se,{modelValue:B.value,"onUpdate:modelValue":e[14]||(e[14]=s=>B.value=s),"max-width":"800px",persistent:""},{default:l(()=>[t(k,{class:"import-dialog"},{default:l(()=>[t(X,{class:"d-flex align-center"},{default:l(()=>[t(x,{class:"mr-2"},{default:l(()=>e[24]||(e[24]=[c("mdi-file-import")])),_:1}),e[26]||(e[26]=c(" Import Cards from Excel ")),t(Y),t(w,{icon:"",onClick:ra,disabled:A.value,variant:"text"},{default:l(()=>[t(x,null,{default:l(()=>e[25]||(e[25]=[c("mdi-close")])),_:1})]),_:1},8,["disabled"])]),_:1}),t(z,{class:"pa-6"},{default:l(()=>[r("div",qa,[r("div",{class:Z(["step",{active:C.value===1}])},e[27]||(e[27]=[r("div",{class:"step-number"},"1",-1),r("div",{class:"step-label"},"Upload Excel File",-1)]),2),r("div",{class:Z(["step",{active:C.value===2}])},e[28]||(e[28]=[r("div",{class:"step-number"},"2",-1),r("div",{class:"step-label"},"Preview Data",-1)]),2),r("div",{class:Z(["step",{active:C.value===3}])},e[29]||(e[29]=[r("div",{class:"step-number"},"3",-1),r("div",{class:"step-label"},"Import Cards",-1)]),2)]),C.value===1?(p(),b("div",Ma,[r("div",ja,[t(x,{size:"64",color:"primary",class:"mb-4"},{default:l(()=>e[30]||(e[30]=[c("mdi-file-excel")])),_:1}),e[33]||(e[33]=r("h3",{class:"mb-2"},"Upload Excel File",-1)),e[34]||(e[34]=r("p",{class:"text-medium-emphasis mb-6"}," Upload an Excel file (.xlsx, .xls) containing card numbers ",-1)),t(w,{color:"secondary",variant:"outlined",class:"mb-4",onClick:Xe,"prepend-icon":"mdi-download"},{default:l(()=>e[31]||(e[31]=[c(" Download Template ")])),_:1}),t(Aa,{modelValue:q.value,"onUpdate:modelValue":[e[11]||(e[11]=s=>q.value=s),Ye],accept:".xlsx,.xls",label:"Choose Excel file",variant:"outlined","prepend-icon":"mdi-paperclip","error-messages":M.value,"hide-details":"",class:"mb-4"},null,8,["modelValue","error-messages"]),e[35]||(e[35]=r("div",{class:"file-requirements"},[r("h4",{class:"mb-2"},"File Requirements:"),r("ul",{class:"text-caption text-medium-emphasis"},[r("li",null,"File must be in Excel format (.xlsx or .xls)"),r("li",null,"First column should contain card numbers"),r("li",null,"Second column should contain access level numbers")])],-1)),q.value?(p(),b("div",za,[t(w,{color:"primary",size:"large",onClick:ea,disabled:A.value,"prepend-icon":"mdi-import"},{default:l(()=>e[32]||(e[32]=[c(" IMPORT CARDS ")])),_:1},8,["disabled"])])):Ee("",!0)])])):C.value===2?(p(),b("div",Ha,[t(k,{variant:"outlined"},{default:l(()=>[t(X,{class:"d-flex align-center"},{default:l(()=>[t(x,{class:"mr-2"},{default:l(()=>e[36]||(e[36]=[c("mdi-table-eye")])),_:1}),e[37]||(e[37]=c(" Preview Import Data ")),t(Y),r("span",Oa,v(S.value.length)+" cards found ",1)]),_:1}),t(z,null,{default:l(()=>[r("div",Qa,[t(La,{density:"comfortable",class:"preview-table"},{default:l(()=>[e[38]||(e[38]=r("thead",null,[r("tr",null,[r("th",null,"#"),r("th",null,"Card Number"),r("th",null,"Access Level Number"),r("th",null,"Access Level Name"),r("th",null,"Type"),r("th",null,"Status")])],-1)),r("tbody",null,[(p(!0),b($e,null,Te(S.value,(s,o)=>(p(),b("tr",{key:o},[r("td",null,v(o+1),1),r("td",null,v(s.cardNumber),1),r("td",null,v(s.accessLevelNumber||"N/A"),1),r("td",null,v(s.accessLevelName||"N/A"),1),r("td",null,[t(me,{size:"small",variant:"tonal"},{default:l(()=>[c(v(s.type),1)]),_:2},1024)]),r("td",null,[t(x,{color:s.valid?"success":"error",size:"small"},{default:l(()=>[c(v(s.valid?"mdi-check":"mdi-alert"),1)]),_:2},1032,["color"]),r("span",Ka,v(s.valid?"Valid":"Invalid"),1)])]))),128))])]),_:1})]),r("div",Wa,[t(w,{variant:"outlined",onClick:e[12]||(e[12]=s=>C.value=1),"prepend-icon":"mdi-arrow-left",class:"mr-2"},{default:l(()=>e[39]||(e[39]=[c(" BACK ")])),_:1}),t(w,{color:"primary",onClick:Ne,disabled:!Ue.value,"prepend-icon":"mdi-import"},{default:l(()=>e[40]||(e[40]=[c(" START IMPORT ")])),_:1},8,["disabled"])])]),_:1})]),_:1})])):C.value===3?(p(),b("div",Ja,[t(k,{variant:"outlined"},{default:l(()=>[t(X,{class:"d-flex align-center"},{default:l(()=>[t(x,{class:"mr-2"},{default:l(()=>e[41]||(e[41]=[c("mdi-progress-upload")])),_:1}),e[42]||(e[42]=c(" Importing Cards... ")),t(Y),r("span",Xa,v(N.value.current)+"/"+v(N.value.total),1)]),_:1}),t(z,null,{default:l(()=>[r("div",Ya,[t(ka,{modelValue:N.value.percentage,"onUpdate:modelValue":e[13]||(e[13]=s=>N.value.percentage=s),height:"20",rounded:"",color:"primary",class:"mb-2"},{default:l(({value:s})=>[r("strong",null,v(Math.ceil(s))+"%",1)]),_:1},8,["modelValue"]),r("div",Za," Processing: "+v(ae.value),1)]),t(Ia,{class:"stats-row"},{default:l(()=>[t(G,{cols:"3"},{default:l(()=>[t(k,{variant:"flat",color:"success",class:"text-center pa-3"},{default:l(()=>[r("div",Ga,v(f.value.success),1),e[43]||(e[43]=r("div",{class:"text-caption"},"Success",-1))]),_:1})]),_:1}),t(G,{cols:"3"},{default:l(()=>[t(k,{variant:"flat",color:"error",class:"text-center pa-3"},{default:l(()=>[r("div",es,v(f.value.failed),1),e[44]||(e[44]=r("div",{class:"text-caption"},"Failed",-1))]),_:1})]),_:1}),t(G,{cols:"3"},{default:l(()=>[t(k,{variant:"flat",color:"warning",class:"text-center pa-3"},{default:l(()=>[r("div",as,v(f.value.duplicate),1),e[45]||(e[45]=r("div",{class:"text-caption"},"Duplicate",-1))]),_:1})]),_:1}),t(G,{cols:"3"},{default:l(()=>[t(k,{variant:"flat",color:"info",class:"text-center pa-3"},{default:l(()=>[r("div",ss,v(f.value.total),1),e[46]||(e[46]=r("div",{class:"text-caption"},"Total",-1))]),_:1})]),_:1})]),_:1}),r("div",ts,[e[47]||(e[47]=r("h4",{class:"mb-2"},"Import Log",-1)),t(k,{variant:"outlined",class:"log-container"},{default:l(()=>[t(z,{class:"pa-0"},{default:l(()=>[t(Sa,{density:"compact"},{default:l(()=>[(p(!0),b($e,null,Te(V.value,(s,o)=>(p(),pe(Va,{key:o,class:Z(oa(s.type))},{prepend:l(()=>[t(x,{color:na(s.type),size:"small"},{default:l(()=>[c(v(da(s.type)),1)]),_:2},1032,["color"])]),default:l(()=>[t(_a,{class:"text-caption"},{default:l(()=>[c(v(s.message),1)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})]),r("div",ls,[N.value.completed?(p(),pe(w,{key:0,color:"primary",onClick:la,"prepend-icon":"mdi-check"},{default:l(()=>e[48]||(e[48]=[c(" FINISH ")])),_:1})):(p(),pe(w,{key:1,color:"error",variant:"outlined",onClick:Ae,disabled:!A.value,"prepend-icon":"mdi-cancel"},{default:l(()=>e[49]||(e[49]=[c(" CANCEL IMPORT ")])),_:1},8,["disabled"]))])]),_:1})]),_:1})])):Ee("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Ve,{modelValue:le.value,"onUpdate:modelValue":e[15]||(e[15]=s=>le.value=s),color:"success",timeout:"3000",location:"top"},{default:l(()=>[r("div",rs,[t(x,{class:"me-2"},{default:l(()=>e[50]||(e[50]=[c("mdi-check-circle")])),_:1}),c(" "+v(ye.value),1)])]),_:1},8,["modelValue"]),t(Ve,{modelValue:re.value,"onUpdate:modelValue":e[16]||(e[16]=s=>re.value=s),color:"error",timeout:"3000",location:"top"},{default:l(()=>[r("div",os,[t(x,{class:"me-2"},{default:l(()=>e[51]||(e[51]=[c("mdi-alert-circle")])),_:1}),c(" "+v(be.value),1)])]),_:1},8,["modelValue"])]))}},cs=ca(ns,[["__scopeId","data-v-7b6a6215"]]);export{cs as default};
