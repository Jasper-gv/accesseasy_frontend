import{an as $e,_ as pe,r as g,o as ye,E as F,a as V,e as v,w as d,f as n,j as Ce,$ as Ve,i as t,H as ie,p as D,a0 as He,s as N,a3 as R,D as De,G as Te,aJ as Oe,aH as Se,l as w,U as we,x,aj as _e,W as Ae,V as Ee,y as J,K as Z,L as K,k as A,aK as Ne,aw as re,N as ne,Z as ce,F as de,aL as Ie,aM as Ue,aN as se,aO as Fe,aP as ue,B as ve,q as me,C as ge,g as Me,h as ke,v as be,I as We,J as xe,aQ as je,aR as Be,af as ze,c as Pe,P as Re,X as qe,b as Ge,S as Qe,Q as Ye,R as Je,T as Xe,aD as Ke,a1 as Ze,m as et,al as tt,av as at}from"./index-B12n8wa1.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=$e("PencilIcon",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),ot={class:"d-flex align-center"},st={class:"white--text text-subtitle-2"},it={key:1},nt={key:1},rt={__name:"assignToEmployee",props:{config:{type:Object,required:!0},gradeName:{type:String,required:!0},updateAlteredData:{type:Function,required:!0}},setup(M){const G=M,E=g(""),L=g(1),i=g(25),f=g(0),P=g(null),O=g(null),I=g(!1),_=g([]),U=g([]),B=g([]),z=g("unassigned");let W=null;const H=[{title:"Employee ID",align:"start",key:"employeeId",sortable:!0},{title:"Employee Name",align:"start",key:"name",sortable:!0},{title:"Department",align:"start",key:"departmentName",sortable:!0},{title:"Organization",align:"start",key:"orgName",sortable:!0},{title:"Assign Template",align:"center",key:"assign",sortable:!1}],q=async()=>{const p={"filter[assignedUser][tenant][_eq]":await Z.getTenantId()};return z.value==="unassigned"?p["filter[config][_null]"]="true":p["filter[_and][0][config][id][_eq]"]=G.config.id,P.value&&(p["filter[department][id][_eq]"]=P.value),O.value&&(p["filter[_and][0][assignedUser][organization][id][_eq]"]=O.value),E.value&&(p["filter[_or][0][assignedUser][first_name][_icontains]"]=E.value,p["filter[_or][1][employeeId][_icontains]"]=E.value),p},C=async()=>{var h,p,c;try{const k=J.getToken(),j=await q(),l=new URLSearchParams({...j,"aggregate[count]":"id"}),e=await fetch(`https://appv1.fieldseasy.com/directus/items/personalModule?${l}`,{headers:{Authorization:`Bearer ${k}`,"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to fetch aggregate count");const a=await e.json(),$=(c=(p=(h=a==null?void 0:a.data)==null?void 0:h[0])==null?void 0:p.count)==null?void 0:c.id;f.value=$?Number($):0}catch(k){console.error("Error fetching aggregate count:",k),f.value=0}},o=async()=>{I.value=!0;try{const h=J.getToken(),p=await q(),c=new URLSearchParams({...p,fields:["config","config.attendanceSettings","salaryConfig","config.attendancePolicies","config.leave","id","employeeId","assignedUser.first_name","assignedUser.tenant","assignedUser.organization.id","assignedUser.organization.orgName","assignedUser.organization.orgType","department.id","department.departmentName"].join(","),sort:"id",page:L.value,limit:i.value}),k=await fetch(`https://appv1.fieldseasy.com/directus/items/personalModule?${c}`,{headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}});if(!k.ok)throw new Error(`Failed to fetch employees: ${k.statusText}`);const j=await k.json();if(!j||!Array.isArray(j.data))throw console.error("Invalid API response: data.data is not an array",j),B.value=[],new Error("Invalid API response format");B.value=j.data.map(l=>{var e,a,$,Q,S,le;return l?{...l,first_name:((e=l.assignedUser)==null?void 0:e.first_name)||"",departmentName:((a=l.department)==null?void 0:a.departmentName)||"Not Assigned",orgName:((Q=($=l.assignedUser)==null?void 0:$.organization)==null?void 0:Q.orgName)||"N/A",orgType:((le=(S=l.assignedUser)==null?void 0:S.organization)==null?void 0:le.orgType)||"N/A",isAssigned:!!l.config,updating:!1}:(console.warn("Null employee record found in response"),null)}).filter(l=>l!==null),await C()}catch(h){console.error("Error fetching employees:",h),B.value=[]}finally{I.value=!1}},u=async()=>{try{const h=J.getToken(),p=await Z.getTenantId(),c=await fetch(`https://appv1.fieldseasy.com/directus/items/department?filter[tenant][tenantId][_eq]=${p}`,{headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}});if(!c.ok)throw new Error("Failed to fetch departments");const k=await c.json();_.value=k.data}catch(h){console.error("Error fetching departments:",h)}},m=async()=>{try{const h=J.getToken(),p=await Z.getTenantId(),c=await fetch(`https://appv1.fieldseasy.com/directus/items/organization?filter[tenant][tenantId][_eq]=${p}`,{headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}});if(!c.ok)throw new Error("Failed to fetch organizations");const k=await c.json();U.value=k.data}catch(h){console.error("Error fetching organizations:",h)}},r=async h=>{h.updating=!0;try{const p=J.getToken();if(!(await fetch(`https://appv1.fieldseasy.com/directus/items/personalModule/${h.id}`,{method:"PATCH",headers:{Authorization:`Bearer ${p}`,"Content-Type":"application/json"},body:JSON.stringify({config:h.isAssigned?G.config.id:null,attendanceSettings:h.isAssigned?G.config.attendanceSettings:null})})).ok)throw new Error("Failed to update assignment");h.config=h.isAssigned?{id:G.config.id}:null,await o()}catch(p){console.error("Error updating assignment:",p),h.isAssigned=!h.isAssigned}finally{h.updating=!1}},ee=()=>{W&&clearTimeout(W),W=setTimeout(()=>{L.value=1,o()},300)},X=h=>{const p=["primary","secondary","accent","error","warning","info","success"],c=h.split("").reduce((k,j)=>k+j.charCodeAt(0),0);return p[c%p.length]};return ye(()=>{Promise.all([u(),m(),o()])}),F([P,O,z,E],()=>{L.value=1,o()},{deep:!0}),F([L,i],()=>{o()}),(h,p)=>(v(),V(Ee,{fluid:"",class:"pa-4"},{default:d(()=>[n(Ce,{class:"elevation-3 rounded-lg"},{default:d(()=>[n(Ve,{class:"d-flex flex-wrap align-center py-4 px-6 bg-white"},{default:d(()=>[n(ie,{size:"29",color:"primary",class:"mr-3"},{default:d(()=>p[6]||(p[6]=[D("mdi-account-group")])),_:1}),p[7]||(p[7]=t("span",{class:"text-h5 font-weight-bold"},"Employee Details",-1)),n(He),n(N,{modelValue:E.value,"onUpdate:modelValue":p[0]||(p[0]=c=>E.value=c),"prepend-inner-icon":"mdi-magnify",label:"Search employees...","single-line":"","hide-details":"",filled:"",rounded:"",variant:"outlined",density:"compact",dense:"",class:"mt-3 mt-sm-0 mx-sm-2",style:{"max-width":"300px"},onInput:ee},null,8,["modelValue"]),n(R,{modelValue:P.value,"onUpdate:modelValue":[p[1]||(p[1]=c=>P.value=c),o],items:[{id:null,departmentName:"All"},..._.value],label:"Department","item-title":"departmentName","item-value":"id","hide-details":"",filled:"",rounded:"",variant:"outlined",density:"compact",dense:"",style:{"max-width":"200px"},class:"mt-3 mt-sm-0"},null,8,["modelValue","items"]),n(R,{modelValue:O.value,"onUpdate:modelValue":[p[2]||(p[2]=c=>O.value=c),o],items:[{id:null,orgName:"All"},...U.value],label:"Organization","item-title":"orgName","item-value":"id","hide-details":"",filled:"",rounded:"",variant:"outlined",density:"compact",dense:"",style:{"max-width":"200px"},class:"mt-3 mt-sm-0 ml-sm-2"},null,8,["modelValue","items"])]),_:1}),n(De,{modelValue:z.value,"onUpdate:modelValue":[p[3]||(p[3]=c=>z.value=c),o]},{default:d(()=>[n(Te,{value:"unassigned",style:{"text-transform":"none"}},{default:d(()=>p[8]||(p[8]=[D("Unassigned Employees")])),_:1}),n(Te,{value:"assigned",style:{"text-transform":"none"}},{default:d(()=>p[9]||(p[9]=[D("Assigned Employees")])),_:1})]),_:1},8,["modelValue"]),n(Oe,{headers:H,items:B.value,height:"calc(82vh - 250px)",loading:I.value,class:"elevation-1","hide-default-footer":"","show-select":"","header-props":{style:"background-color: #f5f5f5"}},{"item.employeeId":d(({item:c})=>[D(x(c.employeeId||"N/A"),1)]),"item.name":d(({item:c})=>[t("div",ot,[n(_e,{size:"32",color:"primary",class:"mr-2"},{default:d(()=>{var k;return[t("span",st,x(((k=c.first_name)==null?void 0:k.charAt(0))||""),1)]}),_:2},1024),D(" "+x(c.first_name||""),1)])]),"item.departmentName":d(({item:c})=>[c.departmentName?(v(),V(we,{key:0,color:X(c.departmentName),"text-color":"white",small:""},{default:d(()=>[D(x(c.departmentName),1)]),_:2},1032,["color"])):(v(),w("span",it,"Not Assigned"))]),"item.orgName":d(({item:c})=>[c.orgName?(v(),V(we,{key:0,color:X(c.orgName),"text-color":"white",small:""},{default:d(()=>[D(x(c.orgName)+" ("+x(c.orgType||"N/A")+") ",1)]),_:2},1032,["color"])):(v(),w("span",nt,"N/A"))]),"item.assign":d(({item:c})=>[n(Se,{modelValue:c.isAssigned,"onUpdate:modelValue":k=>c.isAssigned=k,color:"success","hide-details":"",inset:"",onChange:k=>r(c),loading:c.updating},null,8,["modelValue","onUpdate:modelValue","onChange","loading"])]),_:1},8,["items","loading"]),n(Ae,{page:L.value,"onUpdate:page":p[4]||(p[4]=c=>L.value=c),"items-per-page":i.value,"onUpdate:itemsPerPage":p[5]||(p[5]=c=>i.value=c),"total-items":f.value,class:"mt-4"},null,8,["page","items-per-page","total-items"])]),_:1})]),_:1}))}},dt=pe(rt,[["__scopeId","data-v-b6343688"]]),ut={class:"penalty-settings-container"},ct={class:"content"},mt={class:"policy-card"},pt={class:"policy-header"},yt={class:"header-actions"},ft={class:"policy-content"},vt={class:"setting-item"},gt={class:"hours-input-wrapper"},bt=["disabled"],ht={key:0,class:"error-message"},Tt={class:"policy-card"},wt={class:"policy-header"},kt={class:"policy-title"},xt={style:{"background-color":"#ff9e9f",width:"2rem",height:"2rem","border-radius":"0.5rem",display:"flex","align-items":"center","justify-content":"center",color:"white"}},Pt={class:"toggle"},Ct=["disabled"],Vt={key:0,class:"policy-content"},Ht={class:"policy-type-section"},At={class:"policy-type-buttons"},Et=["onClick","disabled"],Lt={class:"form-grid"},$t={class:"form-group"},Dt={class:"time-input-wrapper"},Ot={class:"form-group"},St={key:0,class:"error-message"},_t={class:"form-label"},Nt={key:1,class:"custom-lop-wrapper"},It={class:"custom-lop-field"},Ut=["disabled"],Ft={key:0},Mt={class:"policy-card"},Wt={class:"policy-header"},jt={class:"policy-title"},Bt={style:{"background-color":"#77c3ab",width:"2rem",height:"2rem","border-radius":"0.5rem",display:"flex","align-items":"center","justify-content":"center",color:"white"}},zt={class:"toggle"},Rt=["disabled"],qt={key:0,class:"policy-content"},Gt={class:"subsection"},Qt={class:"form-grid"},Yt={class:"form-group"},Jt={class:"form-group"},Xt={class:"form-group"},Kt={class:"subsection"},Zt={class:"form-grid"},ea={class:"form-group"},ta={class:"form-group"},aa={class:"subsection"},la={class:"form-grid"},oa={class:"form-group"},sa={class:"form-group"},ia={class:"policy-card"},na={class:"policy-header"},ra={class:"policy-title"},da={style:{"background-color":"#ff9e9f",width:"2rem",height:"2rem","border-radius":"0.5rem",display:"flex","align-items":"center","justify-content":"center",color:"white"}},ua={class:"toggle"},ca=["disabled"],ma={key:0,class:"policy-content"},pa={class:"policy-type-section"},ya={class:"policy-type-buttons"},fa=["onClick","disabled"],va={class:"form-grid"},ga={class:"form-group"},ba={class:"form-group"},ha={class:"form-group"},Ta={key:1,class:"custom-lop-wrapper"},wa={class:"custom-lop-field"},ka=["disabled"],xa={key:0,class:"form-group"},Pa={class:"policy-card"},Ca={class:"policy-header"},Va={class:"policy-title"},Ha={style:{"background-color":"#fc5354",width:"2rem",height:"2rem","border-radius":"0.5rem",display:"flex","align-items":"center","justify-content":"center",color:"white"}},Aa={class:"toggle"},Ea=["disabled"],La={key:0,class:"policy-content"},$a={class:"policy-type-section"},Da={class:"policy-type-buttons"},Oa=["onClick","disabled"],Sa={class:"form-grid"},_a={class:"form-group"},Na={key:1,class:"custom-lop-wrapper"},Ia={class:"custom-lop-field"},Ua=["disabled"],Fa={key:0},Ma={class:"modal-header"},Wa={class:"modal-header"},ja={class:"modal-header"},Ba={__name:"penality&OverTime",props:{config:{type:Object,required:!0},policyPatch:{type:Number,required:!0},showSnackbar:{type:Function,required:!0}},emits:[],setup(M,{emit:G}){const E=M;Z.getTenantId();const L=J.getToken(),i=g(!1),f=g(null),P=g(null),O=g(!1),I=g(!1),_=g(!1),U=g(!1),B=g(""),z=g("info"),W=(l,e="info")=>{B.value=l,z.value=e,U.value=!0,setTimeout(()=>{U.value=!1},3e3)},H=K({totalWorkingHours:"",lateGracePeriod:"",earlyGracePeriod:"",lateWaiveOffDays:"",earlyWaiveOffDays:"",workingHoursDaysLimit:""}),q=g([{title:"Casual Leave",value:"casual"},{title:"Sick Leave",value:"sick"},{title:"Annual Leave",value:"annual"},{title:"Personal Leave",value:"personal"}]),C=K({locationCentric:!1,calculate_WithInBreak:!1,totalWorkingHours:9}),o=K({enabled:!1,penaltyType:"amount",gracePeriod:"",fineAmount:"",waiveOffDays:"",deductionType:"",leaveType:""}),u=K({enabled:!1,penaltyType:"amount",gracePeriod:"",fineAmount:"",waiveOffDays:"",deductionType:"",leaveType:""}),m=K({enabled:!1,gracePeriod:"",extraHoursType:"",extraHoursPay:"",weekOffPayType:"",weekOffPay:"",publicHolidayPayType:"",publicHolidayPay:""}),r=K({enabled:!1,minimumHours:"",penaltyType:"",fineAmount:"",waiveOffDays:"",deductionType:"",workinghrsDaysLimit:"",leaveType:""}),ee=()=>{const l=Number(C.totalWorkingHours);return isNaN(l)||l<1||l>9?(H.totalWorkingHours="Total working hours must be between 1 and 9 hours",!1):(H.totalWorkingHours="",!0)},X=(l,e)=>{const a=Number(l);return isNaN(a)||a<0||a>360?(H[e]="Grace period must be between 0 and 6 hours (360 minutes)",!1):(H[e]="",!0)},h=(l,e)=>{const a=Number(l);return isNaN(a)||a<3?(H[e]="Waive off days must be 3 or more days",!1):(H[e]="",!0)};F(()=>C.totalWorkingHours,ee),F(()=>o.gracePeriod,l=>X(l,"lateGracePeriod")),F(()=>u.gracePeriod,l=>X(l,"earlyGracePeriod")),F(()=>o.waiveOffDays,l=>h(l,"lateWaiveOffDays")),F(()=>u.waiveOffDays,l=>h(l,"earlyWaiveOffDays")),F(()=>r.workinghrsDaysLimit,l=>h(l,"workingHoursDaysLimit")),F(()=>o.penaltyType,l=>{l==="lop"&&(o.deductionType="fixed")}),F(()=>u.penaltyType,l=>{l==="lop"&&(u.deductionType="fixed")}),F(()=>r.penaltyType,l=>{l==="lop"&&(r.deductionType="fixed")});const p=()=>{i.value=!i.value},c=l=>{const e=l.split(":").map(Number),a=e[0]||0,$=e[1]||0,Q=e[2]||0;return`${a.toString().padStart(2,"0")}:${$.toString().padStart(2,"0")}:${Q.toString().padStart(2,"0")}`},k=async()=>{try{const l={locationCentric:C.locationCentric,calculate_WithInBreak:C.calculate_WithInBreak,TotalWorking_Hours:C.totalWorkingHours,entryTimeLimit:o.enabled,setEntryTimeLimit:c(o.gracePeriod),lateEntryAllowed:parseInt(o.waiveOffDays)||0,lateEntryPenaltyAmt:parseFloat(o.fineAmount)||null,exitTimeLimit:u.enabled,setExitTimeLimit:c(u.gracePeriod),earlyExitAllowed:parseInt(u.waiveOffDays)||0,earlyExitPenaltyAmt:parseFloat(u.fineAmount)||null,isWorkingHours:r.enabled,workinghrsDaysLimit:parseInt(r.workinghrsDaysLimit)||null,workingHoursAmount:parseFloat(r.fineAmount)||null,isOverTime:m.enabled,setOverTimeLimit:c(m.gracePeriod),extraHoursPay:parseFloat(m.extraHoursPay)||null,weekOffPay:parseFloat(m.weekOffPay)||null,publicHolidayPay:parseFloat(m.publicHolidayPay)||null};o.penaltyType!=""&&(l.lateComingType=o.penaltyType),o.deductionType!=""&&(l.LateCommingDayMode=o.deductionType),o.leaveType!=""&&(l.lateCommingLeave=o.leaveType),u.penaltyType!=""&&(l.earlyLeavingType=u.penaltyType),u.deductionType!=""&&(l.earlyLeavingDayMode=u.deductionType),u.leaveType!=""&&(l.earlyLeavingLeave=u.leaveType),r.minimumHours!=""&&(l.setMinWorkingHours=r.minimumHours),r.penaltyType!=""&&(l.workingHoursType=r.penaltyType),r.deductionType!=""&&(l.wrkHoursDayMode=r.deductionType),r.leaveType!=""&&(l.wrkHoursLeave=r.leaveType),m.weekOffPayType!=""&&(l.weekOffType=m.weekOffPayType),m.publicHolidayPayType!=""&&(l.publicHolidayType=m.publicHolidayPayType),m.extraHoursType!=""&&(l.extraHoursType=m.extraHoursType),Object.keys(l).forEach(S=>l[S]===null&&delete l[S]);const e=await fetch(`https://appv1.fieldseasy.com/directus/items/personalModule?filter[_and][0][config][attendancePolicies][id][_eq]=${E.policyPatch}&fields[]=attendancePolicyHistory`,{headers:{Authorization:`Bearer ${L}`}});if(!e.ok)throw new Error("Failed to fetch attendance policy history");const $=(await e.json()).data.filter(S=>S.attendancePolicyHistory!==null).map(S=>S.attendancePolicyHistory);if($.length>0){const S={};if(Object.keys(l).forEach(Y=>{P.value&&P.value[Y]!==void 0&&P.value[Y]!==null&&P.value[Y]!=="00:00:00"&&JSON.stringify(P.value[Y])!==JSON.stringify(l[Y])&&(S[Y]=P.value[Y])}),!(await fetch("https://appv1.fieldseasy.com/directus/items/attendancePolicies",{method:"PATCH",headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json"},body:JSON.stringify({keys:$,data:S})})).ok)throw new Error("Failed to update previous policy")}const Q=await fetch(`https://appv1.fieldseasy.com/directus/items/attendancePolicies/${E.policyPatch}`,{method:"PATCH",headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(Q.ok){const S=await Q.json();P.value=S.data,i.value=!1,W("Settings saved successfully!","success")}else throw new Error("Failed to save settings")}catch(l){console.error("Error saving settings:",l),W(`Error saving settings: ${l.message}`,"error")}},j=()=>{i.value=!1};return ye(async()=>{try{const e=await(await fetch(`https://appv1.fieldseasy.com/directus/items/attendancePolicies/${E.policyPatch}`,{headers:{Authorization:`Bearer ${L}`}})).json();f.value=e.data,P.value=e.data,C.locationCentric=f.value.locationCentric,C.calculate_WithInBreak=f.value.calculate_WithInBreak||!1,C.totalWorkingHours=f.value.TotalWorking_Hours||9,o.enabled=f.value.entryTimeLimit,o.penaltyType=f.value.lateComingType==="amount"?"fixed":f.value.lateComingType||"fixed",o.gracePeriod=f.value.setEntryTimeLimit,o.fineAmount=f.value.lateEntryPenaltyAmt,o.waiveOffDays=f.value.lateEntryAllowed,o.deductionType=f.value.LateCommingDayMode,o.leaveType=f.value.lateCommingLeave,u.enabled=f.value.exitTimeLimit,u.penaltyType=f.value.earlyLeavingType==="amount"?"fixed":f.value.earlyLeavingType||"fixed",u.gracePeriod=f.value.setExitTimeLimit,u.fineAmount=f.value.earlyExitPenaltyAmt,u.waiveOffDays=f.value.earlyExitAllowed,u.deductionType=f.value.earlyLeavingDayMode,u.leaveType=f.value.earlyLeavingLeave,m.enabled=f.value.isOverTime,m.gracePeriod=f.value.setOverTimeLimit,m.extraHoursType=f.value.extraHoursType,m.extraHoursPay=f.value.extraHoursPay,m.weekOffPayType=f.value.weekOffType,m.weekOffPay=f.value.weekOffPay,m.publicHolidayPayType=f.value.publicHolidayType,m.publicHolidayPay=f.value.publicHolidayPay,r.enabled=f.value.isWorkingHours,r.minimumHours=f.value.setMinWorkingHours,r.penaltyType=f.value.workingHoursType==="amount"?"fixed":f.value.workingHoursType||"fixed",r.fineAmount=f.value.workingHoursAmount,r.deductionType=f.value.wrkHoursDayMode,r.workinghrsDaysLimit=f.value.workinghrsDaysLimit,r.leaveType=f.value.wrkHoursLeave,[o.waiveOffDays,u.waiveOffDays,r.waiveOffDays].forEach(a=>{const $=parseInt(a);($<3||$>5)&&(a="3")})}catch(l){console.error("Error fetching attendance policies:",l),W("Error fetching attendance policies. Please try again.","error")}}),(l,e)=>(v(),w("div",ut,[n(Ne,{show:U.value,message:B.value,type:z.value,onClose:e[0]||(e[0]=a=>U.value=!1)},null,8,["show","message","type"]),t("div",ct,[t("div",mt,[t("div",pt,[e[43]||(e[43]=re('<div class="policy-title" data-v-f327a78b><div class="policy-icon general" data-v-f327a78b><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-f327a78b><circle cx="12" cy="12" r="3" data-v-f327a78b></circle><path d="M12 1v6m0 6v6m11-7h-6m-6 0H1" data-v-f327a78b></path></svg></div><span data-v-f327a78b>General Settings</span></div>',1)),t("div",yt,[i.value?(v(),w(de,{key:1},[n(ce,{variant:"danger",size:"md","left-icon":ne(Ie),onClick:j,class:"ms-2"},{default:d(()=>e[41]||(e[41]=[D(" Cancel ")])),_:1},8,["left-icon"]),n(ce,{variant:"primary",size:"md","left-icon":ne(Ue),onClick:k,class:"ms-2"},{default:d(()=>e[42]||(e[42]=[D(" Save Changes ")])),_:1},8,["left-icon"])],64)):(v(),V(ce,{key:0,variant:"primary",size:"md","left-icon":ne(lt),onClick:p},{default:d(()=>e[40]||(e[40]=[D(" Edit ")])),_:1},8,["left-icon"]))])]),t("div",ft,[t("div",vt,[e[45]||(e[45]=t("div",{class:"setting-info"},[t("div",{class:"setting-label"},"Total Working Hours"),t("div",{class:"setting-description"}," Set maximum working hours per day (max 9 hours) ")],-1)),t("div",gt,[se(t("input",{type:"number","onUpdate:modelValue":e[1]||(e[1]=a=>C.totalWorkingHours=a),disabled:!i.value,class:"form-input hours-input",min:"1",max:"9",placeholder:"9"},null,8,bt),[[Fe,C.totalWorkingHours]]),e[44]||(e[44]=t("span",{class:"hours-suffix"},"hours",-1)),H.totalWorkingHours?(v(),w("div",ht,x(H.totalWorkingHours),1)):A("",!0)])])])]),t("div",Tt,[t("div",wt,[t("div",kt,[t("div",xt,[n(ie,{color:"white",size:"22"},{default:d(()=>e[46]||(e[46]=[D("mdi-calendar-outline")])),_:1})]),e[47]||(e[47]=t("span",null,"Working Hours",-1))]),t("label",Pt,[se(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=a=>r.enabled=a),disabled:!i.value},null,8,Ct),[[ue,r.enabled]]),e[48]||(e[48]=t("span",{class:"toggle-slider"},null,-1))])]),r.enabled?(v(),w("div",Vt,[t("div",Ht,[e[49]||(e[49]=t("div",{class:"section-label"},"POLICY TYPE",-1)),t("div",At,[(v(),w(de,null,ve(["fixed","leave","lop"],a=>t("button",{key:a,onClick:$=>!i.value||(r.penaltyType=a),class:me(["policy-type-btn",{active:r.penaltyType===a}]),disabled:!i.value},x(a==="fixed"?"Fixed Amount":a==="leave"?"Leave":"LOP"),11,Et)),64))])]),t("div",Lt,[t("div",$t,[e[50]||(e[50]=t("label",{class:"form-label"},"Minimum Working Hours",-1)),t("div",Dt,[n(N,{modelValue:r.minimumHours,"onUpdate:modelValue":e[3]||(e[3]=a=>r.minimumHours=a),disabled:!i.value,type:"time",variant:"outlined",suffix:"hours","hide-details":""},null,8,["modelValue","disabled"])])]),t("div",Ot,[e[51]||(e[51]=t("label",{class:"form-label"},"Waive Off Days",-1)),n(N,{modelValue:r.workinghrsDaysLimit,"onUpdate:modelValue":e[4]||(e[4]=a=>r.workinghrsDaysLimit=a),disabled:!i.value,type:"number",variant:"outlined","hide-details":""},null,8,["modelValue","disabled"]),H.workingHoursDaysLimit?(v(),w("div",St,x(H.workingHoursDaysLimit),1)):A("",!0)]),t("div",null,[t("label",_t,x(r.penaltyType==="fixed"?"Fine Type":"Deduction Type"),1),r.penaltyType==="fixed"?(v(),V(R,{key:0,modelValue:r.deductionType,"onUpdate:modelValue":e[5]||(e[5]=a=>r.deductionType=a),disabled:!i.value,items:["Fixed Hourly Rate","Custom Multiplier"],variant:"outlined","hide-details":""},null,8,["modelValue","disabled"])):r.penaltyType==="lop"?(v(),w("div",Nt,[t("div",It,[e[53]||(e[53]=t("span",{class:"custom-lop-text"},"Fixed",-1)),t("button",{type:"button",onClick:e[6]||(e[6]=a=>_.value=!0),class:"help-icon-btn",disabled:!i.value},e[52]||(e[52]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),t("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})],-1)]),8,Ut)])])):r.penaltyType==="leave"?(v(),V(R,{key:2,modelValue:r.leaveType,"onUpdate:modelValue":e[7]||(e[7]=a=>r.leaveType=a),disabled:!i.value,items:q.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","disabled","items"])):A("",!0)]),r.penaltyType==="fixed"?(v(),w("div",Ft,[e[54]||(e[54]=t("label",{class:"form-label"},"Amount",-1)),n(N,{modelValue:r.fineAmount,"onUpdate:modelValue":e[8]||(e[8]=a=>r.fineAmount=a),disabled:!i.value,type:"number",suffix:r.deductionType==="Custom Multiplier"?"× per hour":"₹ per hour",placeholder:r.deductionType==="Fixed Hourly Rate"?"₹ Enter Amount":"X Enter Multiplier",variant:"outlined","hide-details":""},null,8,["modelValue","disabled","suffix","placeholder"])])):A("",!0)])])):A("",!0)]),t("div",Mt,[t("div",Wt,[t("div",jt,[t("div",Bt,[n(ie,null,{default:d(()=>e[55]||(e[55]=[D("mdi-clock-outline")])),_:1})]),e[56]||(e[56]=t("span",null,"Overtime Policy",-1))]),t("label",zt,[se(t("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=a=>m.enabled=a),disabled:!i.value},null,8,Rt),[[ue,m.enabled]]),e[57]||(e[57]=t("span",{class:"toggle-slider"},null,-1))])]),m.enabled?(v(),w("div",qt,[t("div",Gt,[e[61]||(e[61]=t("div",{class:"subsection-title"},"Working Hours OT",-1)),t("div",Qt,[t("div",Yt,[e[58]||(e[58]=t("label",{class:"form-label"},"Grace Period",-1)),n(N,{modelValue:m.gracePeriod,"onUpdate:modelValue":e[10]||(e[10]=a=>m.gracePeriod=a),disabled:!i.value,type:"time",variant:"outlined",suffix:"hours","hide-details":""},null,8,["modelValue","disabled"])]),t("div",Jt,[e[59]||(e[59]=t("label",{class:"form-label"},"Extra Hours Pay Type",-1)),n(R,{modelValue:m.extraHoursType,"onUpdate:modelValue":e[11]||(e[11]=a=>m.extraHoursType=a),disabled:!i.value,items:["Fixed Hourly Rate","Custom Multiplier"],variant:"outlined","hide-details":""},null,8,["modelValue","disabled"])]),t("div",Xt,[e[60]||(e[60]=t("label",{class:"form-label"},"Amount",-1)),n(N,{modelValue:m.extraHoursPay,"onUpdate:modelValue":e[12]||(e[12]=a=>m.extraHoursPay=a),disabled:!i.value,type:"number",suffix:m.extraHoursType==="Custom Multiplier"?"× per hour":"₹ per hour",placeholder:m.extraHoursType==="Fixed Hourly Rate"?"₹ Enter Amount":"X Enter Multiplier",variant:"outlined","hide-details":""},null,8,["modelValue","disabled","suffix","placeholder"])])])]),t("div",Kt,[e[64]||(e[64]=t("div",{class:"subsection-title"},"Holiday Pay",-1)),t("div",Zt,[t("div",ea,[e[62]||(e[62]=t("label",{class:"form-label"},"Public Holiday Pay Type",-1)),n(R,{modelValue:m.publicHolidayPayType,"onUpdate:modelValue":e[13]||(e[13]=a=>m.publicHolidayPayType=a),disabled:!i.value,items:["Fixed Hourly Rate","Custom Multiplier"],variant:"outlined","hide-details":""},null,8,["modelValue","disabled"])]),t("div",ta,[e[63]||(e[63]=t("label",{class:"form-label"},"Amount",-1)),n(N,{modelValue:m.publicHolidayPay,"onUpdate:modelValue":e[14]||(e[14]=a=>m.publicHolidayPay=a),disabled:!i.value,type:"number",suffix:m.publicHolidayPayType==="Custom Multiplier"?"× per hour":"₹ per hour",placeholder:m.publicHolidayPayType==="Fixed Hourly Rate"?"₹ Enter Amount":"X Enter Multiplier",variant:"outlined","hide-details":""},null,8,["modelValue","disabled","suffix","placeholder"])])])]),t("div",aa,[e[67]||(e[67]=t("div",{class:"subsection-title"},"Week Off Pay",-1)),t("div",la,[t("div",oa,[e[65]||(e[65]=t("label",{class:"form-label"},"Week Off Pay Type",-1)),n(R,{modelValue:m.weekOffPayType,"onUpdate:modelValue":e[15]||(e[15]=a=>m.weekOffPayType=a),disabled:!i.value,items:["Fixed Hourly Rate","Custom Multiplier"],variant:"outlined","hide-details":""},null,8,["modelValue","disabled"])]),t("div",sa,[e[66]||(e[66]=t("label",{class:"form-label"},"Amount",-1)),n(N,{modelValue:m.weekOffPay,"onUpdate:modelValue":e[16]||(e[16]=a=>m.weekOffPay=a),disabled:!i.value,type:"number",suffix:m.weekOffPayType==="Custom Multiplier"?"× per hour":"₹ per hour",placeholder:m.weekOffPayType==="Fixed Hourly Rate"?"₹ Enter Amount":"X Enter Multiplier",variant:"outlined","hide-details":""},null,8,["modelValue","disabled","suffix","placeholder"])])])])])):A("",!0)]),t("div",ia,[t("div",na,[t("div",ra,[t("div",da,[n(ie,null,{default:d(()=>e[68]||(e[68]=[D("mdi-clock-outline")])),_:1})]),e[69]||(e[69]=t("span",null,"Late Coming Policy",-1))]),t("label",ua,[se(t("input",{type:"checkbox","onUpdate:modelValue":e[17]||(e[17]=a=>o.enabled=a),disabled:!i.value},null,8,ca),[[ue,o.enabled]]),e[70]||(e[70]=t("span",{class:"toggle-slider"},null,-1))])]),o.enabled?(v(),w("div",ma,[t("div",pa,[e[71]||(e[71]=t("div",{class:"section-label"},"POLICY TYPE",-1)),t("div",ya,[(v(),w(de,null,ve(["fixed","leave","lop"],a=>t("button",{key:a,onClick:$=>!i.value||(o.penaltyType=a),class:me(["policy-type-btn",{active:o.penaltyType===a}]),disabled:!i.value},x(a==="fixed"?"Fixed Amount":a==="leave"?"Leave":"LOP"),11,fa)),64))])]),t("div",va,[t("div",ga,[e[72]||(e[72]=t("label",{class:"form-label"},"Grace Period",-1)),n(N,{modelValue:o.gracePeriod,"onUpdate:modelValue":e[18]||(e[18]=a=>o.gracePeriod=a),disabled:!i.value,type:"time",suffix:"hours",variant:"outlined","hide-details":""},null,8,["modelValue","disabled"])]),t("div",ba,[e[73]||(e[73]=t("label",{class:"form-label"},"Waive Off Days",-1)),n(N,{modelValue:o.waiveOffDays,"onUpdate:modelValue":e[19]||(e[19]=a=>o.waiveOffDays=a),disabled:!i.value,type:"number",min:"3",suffix:"days",variant:"outlined","hide-details":""},null,8,["modelValue","disabled"])]),t("div",ha,[e[76]||(e[76]=t("label",{class:"form-label"},"Deduction Type",-1)),o.penaltyType==="fixed"?(v(),V(R,{key:0,modelValue:o.deductionType,"onUpdate:modelValue":e[20]||(e[20]=a=>o.deductionType=a),disabled:!i.value,items:["Fixed Hourly Rate","Custom Multiplier"],variant:"outlined","hide-details":""},null,8,["modelValue","disabled"])):o.penaltyType==="lop"?(v(),w("div",Ta,[t("div",wa,[e[75]||(e[75]=t("span",{class:"custom-lop-text"},"Fixed",-1)),t("button",{type:"button",onClick:e[21]||(e[21]=a=>O.value=!0),class:"help-icon-btn",disabled:!i.value},e[74]||(e[74]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),t("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})],-1)]),8,ka)])])):o.penaltyType==="leave"?(v(),V(R,{key:2,modelValue:o.leaveType,"onUpdate:modelValue":e[22]||(e[22]=a=>o.leaveType=a),disabled:!i.value,items:q.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","disabled","items"])):A("",!0)]),o.penaltyType==="fixed"?(v(),w("div",xa,[e[77]||(e[77]=t("label",{class:"form-label"},"Amount",-1)),n(N,{modelValue:o.fineAmount,"onUpdate:modelValue":e[23]||(e[23]=a=>o.fineAmount=a),disabled:!i.value,type:"number",suffix:o.deductionType==="Custom Multiplier"?"× per hour":"₹ per hour",placeholder:o.deductionType==="Fixed Hourly Rate"?"₹ Enter Amount":"X Enter Multiplier",variant:"outlined","hide-details":""},null,8,["modelValue","disabled","suffix","placeholder"])])):A("",!0)])])):A("",!0)]),t("div",Pa,[t("div",Ca,[t("div",Va,[t("div",Ha,[n(ie,null,{default:d(()=>e[78]||(e[78]=[D("mdi-clock-outline")])),_:1})]),e[79]||(e[79]=t("span",null,"Early Leaving Policy",-1))]),t("label",Aa,[se(t("input",{type:"checkbox","onUpdate:modelValue":e[24]||(e[24]=a=>u.enabled=a),disabled:!i.value},null,8,Ea),[[ue,u.enabled]]),e[80]||(e[80]=t("span",{class:"toggle-slider"},null,-1))])]),u.enabled?(v(),w("div",La,[t("div",$a,[e[81]||(e[81]=t("div",{class:"section-label"},"POLICY TYPE",-1)),t("div",Da,[(v(),w(de,null,ve(["fixed","leave","lop"],a=>t("button",{key:a,onClick:$=>!i.value||(u.penaltyType=a),class:me(["policy-type-btn",{active:u.penaltyType===a}]),disabled:!i.value},x(a==="fixed"?"Fixed Amount":a==="leave"?"Leave":"LOP"),11,Oa)),64))])]),t("div",Sa,[t("div",_a,[e[82]||(e[82]=t("label",{class:"form-label"},"Grace Period",-1)),n(N,{modelValue:u.gracePeriod,"onUpdate:modelValue":e[25]||(e[25]=a=>u.gracePeriod=a),disabled:!i.value,type:"time",suffix:"hours",variant:"outlined","hide-details":""},null,8,["modelValue","disabled"])]),t("div",null,[e[83]||(e[83]=t("label",{class:"form-label"},"Waive Off Days",-1)),n(N,{modelValue:u.waiveOffDays,"onUpdate:modelValue":e[26]||(e[26]=a=>u.waiveOffDays=a),disabled:!i.value,type:"number",suffix:"days",variant:"outlined","hide-details":""},null,8,["modelValue","disabled"])]),t("div",null,[e[86]||(e[86]=t("label",{class:"form-label"},"Deduction Type",-1)),u.penaltyType==="fixed"?(v(),V(R,{key:0,modelValue:u.deductionType,"onUpdate:modelValue":e[27]||(e[27]=a=>u.deductionType=a),disabled:!i.value,items:["Fixed Hourly Rate","Custom Multiplier"],variant:"outlined","hide-details":""},null,8,["modelValue","disabled"])):u.penaltyType==="lop"?(v(),w("div",Na,[t("div",Ia,[e[85]||(e[85]=t("span",{class:"custom-lop-text"},"Fixed",-1)),t("button",{type:"button",onClick:e[28]||(e[28]=a=>I.value=!0),class:"help-icon-btn",disabled:!i.value},e[84]||(e[84]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),t("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})],-1)]),8,Ua)])])):u.penaltyType==="leave"?(v(),V(R,{key:2,modelValue:u.leaveType,"onUpdate:modelValue":e[29]||(e[29]=a=>u.leaveType=a),disabled:!i.value,items:q.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","disabled","items"])):A("",!0)]),u.penaltyType==="fixed"?(v(),w("div",Fa,[e[87]||(e[87]=t("label",{class:"form-label"},"Amount",-1)),n(N,{modelValue:u.fineAmount,"onUpdate:modelValue":e[30]||(e[30]=a=>u.fineAmount=a),disabled:!i.value,type:"number",suffix:u.deductionType==="Custom Multiplier"?"× per hour":"₹ per hour",placeholder:u.deductionType==="Fixed Hourly Rate"?"₹ Enter Amount":"X Enter Multiplier",variant:"outlined","hide-details":""},null,8,["modelValue","disabled","suffix","placeholder"])])):A("",!0)])])):A("",!0)])]),O.value?(v(),w("div",{key:0,class:"modal-overlay",onClick:e[33]||(e[33]=a=>O.value=!1)},[t("div",{class:"modal-content",onClick:e[32]||(e[32]=ge(()=>{},["stop"]))},[t("div",Ma,[e[89]||(e[89]=t("h3",null,"Late Coming LOP Fixed Calculation",-1)),t("button",{onClick:e[31]||(e[31]=a=>O.value=!1),class:"modal-close"},e[88]||(e[88]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))]),e[90]||(e[90]=re('<div class="modal-body" data-v-f327a78b><div class="calculation-rules" data-v-f327a78b><h4 data-v-f327a78b>Automatic Calculation Based on Late Hours:</h4><ul data-v-f327a78b><li data-v-f327a78b><strong data-v-f327a78b>2 hours late:</strong> Quarter Day (0.25 day deduction) </li><li data-v-f327a78b><strong data-v-f327a78b>4 hours late:</strong> Half Day (0.5 day deduction) </li><li data-v-f327a78b><strong data-v-f327a78b>6 hours late:</strong> Three Quarter Day (0.75 day deduction) </li><li data-v-f327a78b><strong data-v-f327a78b>8+ hours late:</strong> Full Day (1.0 day deduction) </li></ul><p class="note" data-v-f327a78b> The system will automatically calculate the appropriate deduction based on how many hours the employee is late. </p></div></div>',1))])])):A("",!0),I.value?(v(),w("div",{key:1,class:"modal-overlay",onClick:e[36]||(e[36]=a=>I.value=!1)},[t("div",{class:"modal-content",onClick:e[35]||(e[35]=ge(()=>{},["stop"]))},[t("div",Wa,[e[92]||(e[92]=t("h3",null,"Early Leaving LOP Fixed Calculation",-1)),t("button",{onClick:e[34]||(e[34]=a=>I.value=!1),class:"modal-close"},e[91]||(e[91]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))]),e[93]||(e[93]=re('<div class="modal-body" data-v-f327a78b><div class="calculation-rules" data-v-f327a78b><h4 data-v-f327a78b>Automatic Calculation Based on Early Departure Hours:</h4><ul data-v-f327a78b><li data-v-f327a78b><strong data-v-f327a78b>2 hours early:</strong> Quarter Day (0.25 day deduction) </li><li data-v-f327a78b><strong data-v-f327a78b>4 hours early:</strong> Half Day (0.5 day deduction) </li><li data-v-f327a78b><strong data-v-f327a78b>6 hours early:</strong> Three Quarter Day (0.75 day deduction) </li><li data-v-f327a78b><strong data-v-f327a78b>8+ hours early:</strong> Full Day (1.0 day deduction) </li></ul><p class="note" data-v-f327a78b> The system will automatically calculate the appropriate deduction based on how many hours early the employee leaves. </p></div></div>',1))])])):A("",!0),_.value?(v(),w("div",{key:2,class:"modal-overlay",onClick:e[39]||(e[39]=a=>_.value=!1)},[t("div",{class:"modal-content",onClick:e[38]||(e[38]=ge(()=>{},["stop"]))},[t("div",ja,[e[95]||(e[95]=t("h3",null,"Working Hours LOP Fixed Calculation",-1)),t("button",{onClick:e[37]||(e[37]=a=>_.value=!1),class:"modal-close"},e[94]||(e[94]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))]),e[96]||(e[96]=re('<div class="modal-body" data-v-f327a78b><div class="calculation-rules" data-v-f327a78b><h4 data-v-f327a78b>Automatic Calculation Based on Insufficient Working Hours:</h4><ul data-v-f327a78b><li data-v-f327a78b><strong data-v-f327a78b>2 hours short:</strong> Quarter Day (0.25 day deduction) </li><li data-v-f327a78b><strong data-v-f327a78b>4 hours short:</strong> Half Day (0.5 day deduction) </li><li data-v-f327a78b><strong data-v-f327a78b>6 hours short:</strong> Three Quarter Day (0.75 day deduction) </li><li data-v-f327a78b><strong data-v-f327a78b>8+ hours short:</strong> Full Day (1.0 day deduction) </li></ul><p class="note" data-v-f327a78b> The system will automatically calculate the appropriate deduction based on how many hours short of the minimum working hours requirement. </p></div></div>',1))])])):A("",!0)]))}},za=pe(Ba,[["__scopeId","data-v-f327a78b"]]),Ra={style:{"background-color":"#ecfdf5",color:"black",padding:"6px",border:"1px solid #059367"}},qa={class:"text-h6 font-weight-medium mb-0"},Ga={key:1,class:"pa-4 text-center text-muted-foreground"},Qa={key:1,class:"pa-4 text-center text-muted-foreground"},Ya={__name:"attendancePolicyTabs",props:{selectedConfig:{type:Object,default:null},policyPatchId:{type:Number,default:null},showSnackbar:{type:Function,default:null}},emits:[],setup(M,{emit:G}){const E=M,L=G,i=()=>{L("close")},f=g("penalty-settings");return F(()=>E.selectedConfig,P=>{P&&(f.value="penalty-settings")}),ye(()=>{console.log("1",E.selectedConfig)}),(P,O)=>(v(),V(Be,null,{default:d(()=>[n(je,null,{default:d(()=>[n(Ee,{fluid:""},{default:d(()=>[n(Me,{class:"align-center mb-4"},{default:d(()=>[n(ke,{cols:"auto"},{default:d(()=>[n(be,{icon:"mdi-arrow-left",variant:"text",onClick:i})]),_:1}),n(ke,{cols:"3"},{default:d(()=>[t("div",Ra,[t("h2",qa,x(E.selectedConfig.configName),1)])]),_:1})]),_:1}),n(We,{modelValue:f.value,"onUpdate:modelValue":O[0]||(O[0]=I=>f.value=I)},{default:d(()=>[n(xe,{value:"penalty-settings"},{default:d(()=>[M.selectedConfig&&M.policyPatchId?(v(),V(za,{key:0,config:M.selectedConfig,policyPatch:M.policyPatchId},null,8,["config","policyPatch"])):(v(),w("div",Ga," Please select an attendance policy to configure penalty and overtime settings. "))]),_:1}),n(xe,{value:"assign-employee"},{default:d(()=>[M.selectedConfig?(v(),V(dt,{key:0,config:M.selectedConfig,gradeName:"Default Grade",updateAlteredData:()=>{}},null,8,["config"])):(v(),w("div",Qa," Please select an attendance policy to assign employees. "))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}},Ja=pe(Ya,[["__scopeId","data-v-a2ab6020"]]),Xa={class:"logs-container"},Ka={class:"d-flex align-center",style:{gap:"8px"}},Za={__name:"penalityDetails",setup(M){const G=ze(()=>{_.value=1,l()},300);Ge();const E=g([]),L=g(!1),i=g(""),f=g(!0),P=g(!1),O=g(""),I=g("all");g([]);const _=g(1),U=g(25),B=g(0),z=Z.getTenantId(),W=J.getToken(),H=Z.getRole(),q=Z.getUserId(),C=g({key:"date_created",order:"desc"}),o=K({status:"",mode:"",dateFrom:""});Pe(()=>({status:o.status,mode:o.mode,dateFrom:o.dateFrom}));const u=g([]),m=g(!1),r=g({name:""});g([{key:"dateFrom",label:"From Date",type:"date",show:!0},{key:"status",label:"Status",type:"select",show:!0},{key:"mode",label:"Mode",type:"select",show:!0}]);const ee=g([{key:"configName",label:"Penalty Policies",sortable:!0,width:"200px"},{key:"entryTimeLimit",label:"Entry Time Limit",sortable:!1,width:"180px"},{key:"lateEntryAllowed",label:"Late Entry Allowed",sortable:!1,width:"180px"},{key:"setEntryTimeLimit",label:"Set Entry Time Limit",sortable:!1,width:"200px"},{key:"exitTimeLimit",label:"Exit Time Limit",sortable:!1,width:"180px"},{key:"setExitTimeLimit",label:"Set Exit Time Limit",sortable:!1,width:"200px"},{key:"earlyExitAllowed",label:"Early Exit Allowed",sortable:!1,width:"180px"}]),X=async()=>{if(isSaving.value=!0,!r.value.name.trim()){showSnackbar("Category name is required.","warning"),isSaving.value=!1;return}try{if(u.value.find(s=>s.name.toLowerCase()===r.value.name.toLowerCase())){showSnackbar("A template with this name already exists.","warning");return}if(u.value.length>=10){showSnackbar("Maximum number of categories (10) reached. You cannot create more categories.","warning");return}const y=await fetch("https://appv1.fieldseasy.com/directus/items/config",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${J.getToken()}`},body:JSON.stringify({configName:r.value.name.trim(),tenant:z.value,attendanceSettings:{status:"draft"},attendancePolicies:{locationCentric:!1,calculate_WithInBreak:!1},salarySettings:{status:"draft"},leaveSettings:[]})});if(!y.ok){const s=await y.json();throw new Error(s.message||"Failed to create template")}await loadTemplates(),m.value=!1,r.value.name="",showSnackbar("Category added successfully!","success")}catch(T){console.error("Error creating template:",T),showSnackbar(T.message||"Error creating category. Please try again.","error")}finally{isSaving.value=!1}},h=g(!1),p=g(""),c=g(""),k=async T=>{try{const y=T.id;y&&(p.value=T,c.value=y,h.value=!0)}catch(y){console.error("Error loading template details:",y)}},j=async(T=I.value)=>{var y,s,b;try{if(!W||!z)throw new Error("Authentication required or tenant not found");const te={"aggregate[count]":"id",...e(T)},ae=Object.keys(te).map(he=>`${he}=${encodeURIComponent(te[he])}`).join("&"),oe=await fetch(`https://appv1.fieldseasy.com/directus/items/config?${ae}`,{headers:{Authorization:`Bearer ${W}`,"Content-Type":"application/json"}});if(!oe.ok)throw new Error(`HTTP error! status: ${oe.status}`);const fe=await oe.json();B.value=((b=(s=(y=fe==null?void 0:fe.data)==null?void 0:y[0])==null?void 0:s.count)==null?void 0:b.id)||0}catch(te){console.error("Error fetching aggregate count:",te),B.value=0}},l=async()=>{if(!W){P.value=!0,O.value="Authentication required. Please login again.";return}L.value=!0;try{await j();let T={fields:["id","configName","attendanceSettings","attendancePolicies.locationCentric","attendancePolicies.entryTimeLimit","attendancePolicies.setEntryTimeLimit","attendancePolicies.lateEntryAllowed","attendancePolicies.exitTimeLimit","attendancePolicies.setExitTimeLimit","attendancePolicies.earlyExitAllowed","tenant","status","configName","id","leaveSettings","tenant.tenantId","tenant.tenantName"],sort:C.value.key&&C.value.order==="desc"?`-${C.value.key}`:C.value.key,limit:U.value,page:_.value,...e()};const s=`https://appv1.fieldseasy.com/directus/items/config?${Object.keys(T).map(ae=>ae==="fields"?T[ae].map(oe=>`fields[]=${oe}`).join("&"):`${ae}=${encodeURIComponent(T[ae])}`).join("&")}`,b=await fetch(s,{headers:{Authorization:`Bearer ${W}`,"Content-Type":"application/json"}});if(!b.ok)throw new Error(`HTTP error! Status: ${b.status}`);const te=await b.json();E.value=te.data||[]}catch(T){P.value=!0,O.value=T.message||"Failed to fetch salary settings. Please try again."}finally{L.value=!1}},e=(T=I.value)=>{const y={};let s=0;if((H==="Admin"||H==="Dealer"||H==="Administrator")&&(y[`filter[_and][${s}][tenant][tenantId][_eq]`]=z,s++),H==="Manager"&&(y[`filter[_and][${s}][employeeId][approver][id][_eq]`]=q,y[`filter[_and][${s}][employeeId][assignedUser][id][_eq]`]=q,s++),H==="Employee"&&(y[`filter[_and][${s}][employeeId][assignedUser][id][_eq]`]=q,s++),i.value){let b=0;y[`filter[_and][${s}][_or][${b}][employeeId][employeeId][_icontains]`]=i.value,b++,y[`filter[_and][${s}][_or][${b}][employeeId][assignedUser][first_name][_icontains]`]=i.value,b++,y[`filter[_and][${s}][_or][${b}][employeeId][assignedUser][last_name][_icontains]`]=i.value,b++,s++}return o.dateFrom&&(y[`filter[_and][${s}][date][_gte]`]=o.dateFrom,s++),o.status&&(y[`filter[_and][${s}][action][_in]`]=o.status,s++),o.mode&&(y[`filter[_and][${s}][mode][_in]`]=o.mode,s++),y},a=T=>{_.value=T,l()},$=T=>{U.value=T,_.value=1,l()},Q=({field:T,direction:y})=>{C.value={key:T,order:y},l()},S=async T=>{try{const y=await fetch(`https://appv1.fieldseasy.com/directus/items/config/${this.selectedTemplate.id}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${J.getToken()}`},body:JSON.stringify(T)});if(!y.ok){const s=await y.json();throw new Error(s.message||"Failed to save settings")}await this.loadTemplates()}catch(y){throw console.error("Error saving settings:",y),y}};Pe(()=>o.status||o.mode||o.dateFrom||i.value);const le=()=>{Object.keys(o).forEach(T=>{o[T]=Array.isArray(o[T])?[]:""}),_.value=1,l()},Y=()=>{if(u.value.length>=10){showSnackbar("Maximum number of categories (10) reached. You cannot create more categories.","warning");return}r.value.name=`Attendance Category ${u.value.length+1}`,m.value=!0};F([i,o,C,I],()=>{G()},{deep:!0});const Le=async()=>{h.value=!1,await l()};return ye(async()=>{await l()}),(T,y)=>(v(),w("div",Xa,[t("div",{class:me(["main-content",{"full-width":!f.value}])},[h.value?A("",!0):(v(),V(Re,{key:0,searchQuery:i.value,"onUpdate:searchQuery":y[2]||(y[2]=s=>i.value=s),"search-placeholder":"Search Logs...","show-search":!0,"has-error":P.value,"wrapper-class":"logs-table-wrapper"},{"toolbar-actions":d(()=>[t("div",Ka,[ne(H)==="Admin"?(v(),V(ce,{key:0,variant:"primary",size:"md",text:"Create Penalties",leftIcon:ne(Ke),onClick:Y},null,8,["leftIcon"])):A("",!0)])]),pagination:d(()=>[n(Ae,{page:_.value,"onUpdate:page":[y[0]||(y[0]=s=>_.value=s),a],itemsPerPage:U.value,"onUpdate:itemsPerPage":[y[1]||(y[1]=s=>U.value=s),$],"total-items":B.value},null,8,["page","itemsPerPage","total-items"])]),default:d(()=>[L.value?(v(),V(Qe,{key:0,variant:"table-body-only",rows:U.value||10,columns:ee.value.length},null,8,["rows","columns"])):P.value?(v(),V(Ye,{key:1,title:"Unable to load logs",message:O.value,onRetry:l},null,8,["message"])):E.value.length===0&&!L.value?(v(),V(Je,{key:2,title:"No logs data found",message:"Try adjusting your filters or check back later","primary-action":{text:"Clear Filters",icon:"X"},onPrimaryAction:le})):(v(),V(Xe,{key:3,items:E.value,columns:ee.value,"sort-by":C.value.key,"sort-direction":C.value.order,"row-clickable":!0,"item-key":"id",onSort:Q,onRowClick:k},{"cell-configName":d(({item:s})=>[t("span",null,x(s.configName||"-"),1)]),"cell-attendanceSettings":d(({item:s})=>{var b;return[t("span",null,x(((b=s.attendanceSettings)==null?void 0:b.settingName)||"-"),1)]}),"cell-locationCentric":d(({item:s})=>{var b;return[t("span",null,x(((b=s.attendancePolicies)==null?void 0:b.locationCentric)??"-"),1)]}),"cell-entryTimeLimit":d(({item:s})=>{var b;return[t("span",null,x(((b=s.attendancePolicies)==null?void 0:b.entryTimeLimit)??"-"),1)]}),"cell-setEntryTimeLimit":d(({item:s})=>{var b;return[t("span",null,x(((b=s.attendancePolicies)==null?void 0:b.setEntryTimeLimit)??"-"),1)]}),"cell-lateEntryAllowed":d(({item:s})=>{var b;return[t("span",null,x((b=s.attendancePolicies)!=null&&b.lateEntryAllowed?"Yes":"No"),1)]}),"cell-exitTimeLimit":d(({item:s})=>{var b;return[t("span",null,x(((b=s.attendancePolicies)==null?void 0:b.exitTimeLimit)??"-"),1)]}),"cell-setExitTimeLimit":d(({item:s})=>{var b;return[t("span",null,x(((b=s.attendancePolicies)==null?void 0:b.setExitTimeLimit)??"-"),1)]}),"cell-earlyExitAllowed":d(({item:s})=>{var b;return[t("span",null,x((b=s.attendancePolicies)!=null&&b.earlyExitAllowed?"Yes":"No"),1)]}),_:1},8,["items","columns","sort-by","sort-direction"]))]),_:1},8,["searchQuery","has-error"])),p.value?(v(),V(Ja,{key:1,selectedConfig:p.value,policyPatchId:c.value,onSaveChanges:S,showSnackbar:T.showSnackbar,onClose:Le,ref:"policyTabs"},null,8,["selectedConfig","policyPatchId","showSnackbar"])):A("",!0)],2),n(qe,{modelValue:m.value,"onUpdate:modelValue":y[5]||(y[5]=s=>m.value=s),"max-width":"500px"},{default:d(()=>[n(Ce,null,{default:d(()=>[n(Ve,null,{default:d(()=>y[6]||(y[6]=[D("Create New Category")])),_:1}),n(Ze,null,{default:d(()=>[n(N,{modelValue:r.value.name,"onUpdate:modelValue":y[3]||(y[3]=s=>r.value.name=s),label:"Category Name",variant:"outlined",required:"",rules:[s=>!!s||"Category name is required"]},null,8,["modelValue","rules"]),u.value.length>=10?(v(),V(et,{key:0,type:"warning",dense:""},{default:d(()=>y[7]||(y[7]=[D(" Maximum number of categories (10) reached. You cannot create more categories. ")])),_:1})):A("",!0)]),_:1}),n(tt,null,{default:d(()=>[n(He),n(be,{color:"error",text:"",onClick:y[4]||(y[4]=s=>m.value=!1)},{default:d(()=>y[8]||(y[8]=[D("Cancel")])),_:1}),n(be,{onClick:X,loading:T.isSaving,disabled:T.isSaving,color:"primary",class:"save-button"},{loader:d(()=>[n(at,{indeterminate:"",size:"20",width:"2"})]),default:d(()=>[D(" "+x(T.isSaving?"Saving...":"Save Changes"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},tl=pe(Za,[["__scopeId","data-v-0520dbbf"]]);export{tl as default};
