import{p as A}from"./placesService-C-pGz1oz.js";import{d as F}from"./domainService-DG-6YNMl.js";import{_ as I,r as f,c as L,o as H,l as C,f as e,w as a,g as T,j as v,X as J,b as O,d as X,e as S,h as b,i as l,m as P,p as o,v as g,a1 as y,x as i,H as d,aj as h,bb as _,aC as w,$ as D,s as M,aJ as q,U as R,a3 as G,a8 as K,bc as Q,bd as W,al as Y,a0 as Z}from"./index-B12n8wa1.js";const tt={class:"saas-dashboard"},et={class:"d-flex gap-2"},at={class:"d-flex align-center justify-space-between"},st={class:"text-h3 font-weight-bold text-primary"},lt={class:"text-caption text-success mt-1"},ot={class:"d-flex align-center justify-space-between"},it={class:"text-h3 font-weight-bold text-success"},nt={class:"text-caption text-grey mt-1"},rt={class:"d-flex align-center justify-space-between"},dt={class:"text-caption text-grey-darken-1 font-weight-medium mb-1"},ut={class:"text-h3 font-weight-bold text-orange-darken-2"},ct={class:"text-caption text-grey mt-1"},pt={class:"d-flex align-center justify-space-between"},mt={class:"text-h3 font-weight-bold text-purple-darken-1"},ft={class:"d-flex align-center"},vt={class:"d-flex align-center py-2"},gt={class:"text-primary font-weight-bold"},xt={class:"font-weight-medium"},bt={class:"text-caption text-grey"},yt={key:0,class:"d-flex align-center"},ht={class:"mr-2 text-body-2"},_t={key:1,class:"text-grey text-caption"},wt={class:"font-weight-medium"},Vt={class:"d-flex gap-1"},kt={__name:"SaaSAdminDashboard",setup(Ct){const j=O(),n=f([]),p=f({}),x=f(!1),V=f(!1),k=f(""),m=f({name:"",plan:"Starter"}),B=[{title:"Tenant / Place",key:"name",sortable:!0},{title:"Plan",key:"plan",sortable:!0},{title:"Custom Domain",key:"domain",sortable:!1},{title:"Status",key:"status",sortable:!0},{title:"Users",key:"userCount",sortable:!0},{title:"Actions",key:"actions",sortable:!1,align:"end"}],E=L(()=>n.value.reduce((r,t)=>r+(t.userCount||0),0)),N=async()=>{const r=await A.getAll();n.value=r.map((t,u)=>({...t,plan:["Starter","Pro","Enterprise"][u%3],status:"Active",userCount:Math.floor(Math.random()*500)+50}));for(const t of n.value)try{const u=await F.getDomain(t.id);u&&(p.value[t.id]=u)}catch{}},U=async()=>{if(m.value.name){V.value=!0;try{const r=await A.create({name:m.value.name,type:"branch",address:"New Location"});x.value=!1,j.push(`/apps/storefront?placeId=${r.id}`)}catch{alert("Error creating tenant")}finally{V.value=!1}}},$=L(()=>{const r={Starter:29,Pro:99,Enterprise:499};return n.value.reduce((t,u)=>t+(r[u.plan]||0),0)*100}),z=r=>{switch(r){case"Enterprise":return"purple";case"Pro":return"blue";default:return"grey-darken-1"}};return H(N),(r,t)=>{const u=X("router-link");return S(),C("div",tt,[e(T,{class:"mb-6"},{default:a(()=>[e(b,{cols:"12",class:"d-flex justify-space-between align-center"},{default:a(()=>[l("div",null,[t[11]||(t[11]=l("div",{class:"mb-6"},[l("h1",{class:"text-h3 font-weight-bold mb-2 text-primary"},"Platform Subscriptions"),l("p",{class:"text-subtitle-1 text-grey-darken-1"},"Manage billing, plans, and global settings for your locations.")],-1)),e(P,{color:"info",variant:"tonal",icon:"mdi-information",class:"mb-6",closable:""},{default:a(()=>[t[7]||(t[7]=o(" This dashboard focuses on ")),t[8]||(t[8]=l("strong",null,"license management and billing",-1)),t[9]||(t[9]=o(". To configure daily operations, visit the ")),e(u,{to:"/apps/places",class:"font-weight-bold"},{default:a(()=>t[6]||(t[6]=[o("Locations")])),_:1}),t[10]||(t[10]=o(" page. "))]),_:1})]),l("div",et,[e(g,{color:"primary","prepend-icon":"mdi-plus",height:"44",class:"text-none font-weight-medium px-6",onClick:t[0]||(t[0]=s=>x.value=!0)},{default:a(()=>t[12]||(t[12]=[o(" Add New Location ")])),_:1})])]),_:1})]),_:1}),e(T,{class:"mb-6"},{default:a(()=>[e(b,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(v,{class:"stat-card elevation-3",style:{borderLeft:"4px solid #3B82F6"},hover:""},{default:a(()=>[e(y,null,{default:a(()=>[l("div",at,[l("div",null,[t[15]||(t[15]=l("div",{class:"text-caption text-grey-darken-1 font-weight-medium mb-1"},"Total Locations",-1)),l("div",st,i(n.value.length),1),l("div",lt,[e(d,{size:"14",color:"success"},{default:a(()=>t[13]||(t[13]=[o("mdi-arrow-up")])),_:1}),t[14]||(t[14]=o(" +12% this month "))])]),e(h,{color:"primary-lighten-5",size:"56"},{default:a(()=>[e(d,{color:"primary",size:"28"},{default:a(()=>t[16]||(t[16]=[o("mdi-domain")])),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),e(b,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(v,{class:"stat-card elevation-3",style:{borderLeft:"4px solid #10B981"},hover:""},{default:a(()=>[e(y,null,{default:a(()=>[l("div",ot,[l("div",null,[t[17]||(t[17]=l("div",{class:"text-caption text-grey-darken-1 font-weight-medium mb-1"},"Active Subscriptions",-1)),l("div",it,i(n.value.filter(s=>s.status==="Active").length),1),l("div",nt,i((n.value.filter(s=>s.status==="Active").length/n.value.length*100).toFixed(0))+"% active rate ",1)]),e(h,{color:"success-lighten-5",size:"56"},{default:a(()=>[e(d,{color:"success",size:"28"},{default:a(()=>t[18]||(t[18]=[o("mdi-check-circle")])),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),e(b,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(v,{class:"stat-card",style:{borderLeft:"4px solid #F59E0B"},hover:""},{default:a(()=>[e(y,null,{default:a(()=>[l("div",rt,[l("div",null,[l("div",dt,[t[21]||(t[21]=o(" Monthly Recurring Revenue ")),e(_,{location:"top","max-width":"300"},{activator:a(({props:s})=>[e(d,w({size:"14",color:"grey"},s,{class:"ml-1"}),{default:a(()=>t[19]||(t[19]=[o("mdi-information")])),_:2},1040)]),default:a(()=>[t[20]||(t[20]=l("div",{class:"text-caption"},[l("div",{class:"font-weight-bold mb-1"},"How MRR is calculated:"),l("div",null,"Sum of all active monthly subscriptions"),l("div",{class:"mt-2"}," Example: 3 tenants × ₹5,000/month each = ₹15,000 MRR ")],-1))]),_:1})]),l("div",ut,"₹"+i(($.value/100).toLocaleString()),1),l("div",ct," From "+i(n.value.filter(s=>s.status==="Active").length)+" active tenant"+i(n.value.filter(s=>s.status==="Active").length!==1?"s":""),1)]),e(h,{color:"orange-lighten-5",size:"56"},{default:a(()=>[e(d,{color:"orange-darken-1",size:"28"},{default:a(()=>t[22]||(t[22]=[o("mdi-currency-inr")])),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),e(b,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(v,{class:"stat-card elevation-3",style:{borderLeft:"4px solid #8B5CF6"},hover:""},{default:a(()=>[e(y,null,{default:a(()=>[l("div",pt,[l("div",null,[t[23]||(t[23]=l("div",{class:"text-caption text-grey-darken-1 font-weight-medium mb-1"},"Total Users",-1)),l("div",mt,i(E.value.toLocaleString()),1),t[24]||(t[24]=l("div",{class:"text-caption text-grey mt-1"}," Across all tenants ",-1))]),e(h,{color:"purple-lighten-5",size:"56"},{default:a(()=>[e(d,{color:"purple-darken-1",size:"28"},{default:a(()=>t[25]||(t[25]=[o("mdi-account-group")])),_:1})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),e(v,{class:"elevation-3 rounded-lg"},{default:a(()=>[e(D,{class:"d-flex align-center justify-space-between pa-6 bg-grey-lighten-5"},{default:a(()=>[l("div",ft,[e(d,{class:"mr-2",color:"primary"},{default:a(()=>t[26]||(t[26]=[o("mdi-file-certificate")])),_:1}),t[27]||(t[27]=l("span",{class:"text-h6 font-weight-bold"},"Location Subscriptions",-1))]),e(M,{modelValue:k.value,"onUpdate:modelValue":t[1]||(t[1]=s=>k.value=s),"prepend-inner-icon":"mdi-magnify",label:"Search tenants...","single-line":"","hide-details":"",density:"compact",variant:"outlined",class:"search-field",style:{"max-width":"300px"}},null,8,["modelValue"])]),_:1}),e(q,{headers:B,items:n.value,search:k.value,hover:"",class:"elevation-0"},{"item.name":a(({item:s})=>[l("div",vt,[e(h,{color:"primary-lighten-4",size:"40",class:"mr-3"},{default:a(()=>[l("span",gt,i(s.name.charAt(0)),1)]),_:2},1024),l("div",null,[l("div",xt,i(s.name),1),l("div",bt,i(s.type),1)])])]),"item.plan":a(({item:s})=>[e(R,{size:"small",color:z(s.plan),variant:"flat",class:"font-weight-medium"},{default:a(()=>[o(i(s.plan),1)]),_:2},1032,["color"])]),"item.status":a(({item:s})=>[e(R,{size:"small",color:s.status==="Active"?"success":"grey",variant:"flat"},{default:a(()=>[e(d,{start:"",size:"14"},{default:a(()=>[o(i(s.status==="Active"?"mdi-check-circle":"mdi-pause-circle"),1)]),_:2},1024),o(" "+i(s.status),1)]),_:2},1032,["color"])]),"item.domain":a(({item:s})=>[p.value[s.id]?(S(),C("div",yt,[l("span",ht,i(p.value[s.id].domain),1),e(_,{text:p.value[s.id].status==="active"?"SSL Verified":"Pending Verification",location:"top"},{activator:a(({props:c})=>[e(d,w(c,{size:"18",color:p.value[s.id].status==="active"?"success":"warning"}),{default:a(()=>[o(i(p.value[s.id].status==="active"?"mdi-shield-check":"mdi-alert-circle-outline"),1)]),_:2},1040,["color"])]),_:2},1032,["text"])])):(S(),C("span",_t,"No custom domain"))]),"item.userCount":a(({item:s})=>[l("div",wt,i(s.userCount.toLocaleString()),1)]),"item.actions":a(({item:s})=>[l("div",Vt,[e(_,{text:"Configure Storefront",location:"top"},{activator:a(({props:c})=>[e(g,w({size:"small",variant:"text",icon:"mdi-cog",to:`/apps/storefront?placeId=${s.id}`},c,{color:"primary"}),null,16,["to"])]),_:2},1024),e(_,{text:"Sell Memberships",location:"top"},{activator:a(({props:c})=>[e(g,w({size:"small",variant:"text",icon:"mdi-cash-register",to:`/apps/places/membership?placeId=${s.id}`},c,{color:"success"}),null,16,["to"])]),_:2},1024),e(_,{text:"View Live App",location:"top"},{activator:a(({props:c})=>[e(g,w({size:"small",variant:"text",icon:"mdi-open-in-new",href:`/go/app/${s.id}`,target:"_blank"},c,{color:"info"}),null,16,["href"])]),_:2},1024)])]),_:1},8,["items","search"])]),_:1}),e(J,{modelValue:x.value,"onUpdate:modelValue":t[5]||(t[5]=s=>x.value=s),"max-width":"600",persistent:""},{default:a(()=>[e(v,{class:"rounded-lg"},{default:a(()=>[e(D,{class:"d-flex align-center pa-6 bg-primary text-white"},{default:a(()=>[e(d,{class:"mr-2",color:"white"},{default:a(()=>t[28]||(t[28]=[o("mdi-plus-circle")])),_:1}),t[29]||(t[29]=l("span",{class:"text-h5"},"Create New Tenant",-1))]),_:1}),e(y,{class:"pa-6"},{default:a(()=>[e(M,{modelValue:m.value.name,"onUpdate:modelValue":t[2]||(t[2]=s=>m.value.name=s),label:"Organization Name",variant:"outlined","prepend-inner-icon":"mdi-office-building",placeholder:"e.g., Acme Corporation",hint:"This will be displayed in the app","persistent-hint":"",class:"mb-4"},null,8,["modelValue"]),e(G,{modelValue:m.value.plan,"onUpdate:modelValue":t[3]||(t[3]=s=>m.value.plan=s),items:["Starter","Pro","Enterprise"],label:"Subscription Plan",variant:"outlined","prepend-inner-icon":"mdi-star-circle"},{item:a(({props:s,item:c})=>[e(K,Q(W(s)),{prepend:a(()=>[e(d,{color:z(c.value)},{default:a(()=>t[30]||(t[30]=[o("mdi-circle")])),_:2},1032,["color"])]),_:2},1040)]),_:1},8,["modelValue"]),e(P,{type:"info",variant:"tonal",class:"mt-4 text-caption"},{default:a(()=>t[31]||(t[31]=[o(" After creation, you'll be redirected to the Storefront Configurator to customize branding and features. ")])),_:1})]),_:1}),e(Y,{class:"pa-6 pt-0"},{default:a(()=>[e(Z),e(g,{variant:"text",onClick:t[4]||(t[4]=s=>x.value=!1),disabled:V.value},{default:a(()=>t[32]||(t[32]=[o(" Cancel ")])),_:1},8,["disabled"]),e(g,{color:"primary",onClick:U,loading:V.value,"prepend-icon":"mdi-rocket-launch",variant:"flat",class:"px-6"},{default:a(()=>t[33]||(t[33]=[o(" Create & Configure ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Lt=I(kt,[["__scopeId","data-v-c3fa72e0"]]);export{Lt as default};
