import{v as y}from"./visitorService-CAUcA7DC.js";import{r as u,o as _,l as C,i as t,f as e,w as l,g as x,j as d,p as o,e as h,h as n,a1 as b,a7 as M,a8 as f,U as g,ak as D,aJ as S,a as P,k as A,v as k,x as w}from"./index-B12n8wa1.js";const N={__name:"VisitorDashboard",setup(B){const r=u({active:0,expected:0,totalToday:0}),p=u([]),c=u(!0),m=u(null),V=[{title:"Name",key:"name"},{title:"Mobile",key:"mobile"},{title:"Purpose",key:"purpose"},{title:"Host",key:"host"},{title:"Check In",key:"checkInTime"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],v=async()=>{c.value=!0;try{const[s,a]=await Promise.all([y.getStats(),y.getAll()]);r.value=s,p.value=a}catch(s){console.error("Failed to load visitor data",s)}finally{c.value=!1}},T=async s=>{m.value=s.id;try{await y.checkOut(s.id),await v()}catch(a){console.error("Check out failed",a)}finally{m.value=null}};return _(()=>{v()}),(s,a)=>(h(),C("div",null,[a[6]||(a[6]=t("h1",{class:"text-h4 mb-4"},"Visitor Management",-1)),e(x,null,{default:l(()=>[e(n,{cols:"12",md:"4"},{default:l(()=>[e(d,{title:"Active Visitors",subtitle:"Currently on premise",text:r.value.active.toString(),color:"primary",variant:"tonal"},null,8,["text"])]),_:1}),e(n,{cols:"12",md:"4"},{default:l(()=>[e(d,{title:"Expected Today",subtitle:"Pre-registered",text:r.value.expected.toString(),variant:"outlined"},null,8,["text"])]),_:1}),e(n,{cols:"12",md:"4"},{default:l(()=>[e(d,{title:"Total Visits",subtitle:"Today",text:r.value.totalToday.toString(),variant:"outlined"},null,8,["text"])]),_:1})]),_:1}),e(x,{class:"mt-2"},{default:l(()=>[e(n,{cols:"12",md:"8"},{default:l(()=>[e(d,{title:"Visitor Traffic Trends",subtitle:"Last 7 Days"},{default:l(()=>[e(b,null,{default:l(()=>a[0]||(a[0]=[t("div",{class:"d-flex align-end justify-space-between px-4 pb-2",style:{height:"300px"}},[t("div",{class:"d-flex flex-column align-center",style:{width:"12%"}},[t("div",{class:"bg-primary-lighten-2 rounded-t mb-2",style:{width:"60%",height:"45%"}}),t("div",{class:"text-caption text-grey"},"Mon")]),t("div",{class:"d-flex flex-column align-center",style:{width:"12%"}},[t("div",{class:"bg-primary-lighten-2 rounded-t mb-2",style:{width:"60%",height:"60%"}}),t("div",{class:"text-caption text-grey"},"Tue")]),t("div",{class:"d-flex flex-column align-center",style:{width:"12%"}},[t("div",{class:"bg-primary rounded-t mb-2",style:{width:"60%",height:"85%"}}),t("div",{class:"text-caption text-grey font-weight-bold"},"Wed")]),t("div",{class:"d-flex flex-column align-center",style:{width:"12%"}},[t("div",{class:"bg-primary-lighten-2 rounded-t mb-2",style:{width:"60%",height:"55%"}}),t("div",{class:"text-caption text-grey"},"Thu")]),t("div",{class:"d-flex flex-column align-center",style:{width:"12%"}},[t("div",{class:"bg-primary-lighten-2 rounded-t mb-2",style:{width:"60%",height:"70%"}}),t("div",{class:"text-caption text-grey"},"Fri")]),t("div",{class:"d-flex flex-column align-center",style:{width:"12%"}},[t("div",{class:"bg-grey-lighten-1 rounded-t mb-2",style:{width:"60%",height:"30%"}}),t("div",{class:"text-caption text-grey"},"Sat")]),t("div",{class:"d-flex flex-column align-center",style:{width:"12%"}},[t("div",{class:"bg-grey-lighten-1 rounded-t mb-2",style:{width:"60%",height:"20%"}}),t("div",{class:"text-caption text-grey"},"Sun")])],-1)])),_:1})]),_:1})]),_:1}),e(n,{cols:"12",md:"4"},{default:l(()=>[e(d,{title:"Peak Hours",subtitle:"Based on historical data"},{default:l(()=>[e(M,{density:"compact"},{default:l(()=>[e(f,{"prepend-icon":"mdi-clock-time-four",title:"10:00 AM - 11:00 AM"},{append:l(()=>[e(g,{color:"red",size:"small"},{default:l(()=>a[1]||(a[1]=[o("High")])),_:1})]),_:1}),e(f,{"prepend-icon":"mdi-clock-time-three",title:"2:00 PM - 3:00 PM"},{append:l(()=>[e(g,{color:"orange",size:"small"},{default:l(()=>a[2]||(a[2]=[o("Medium")])),_:1})]),_:1}),e(f,{"prepend-icon":"mdi-clock-time-eight",title:"4:00 PM - 5:00 PM"},{append:l(()=>[e(g,{color:"orange",size:"small"},{default:l(()=>a[3]||(a[3]=[o("Medium")])),_:1})]),_:1})]),_:1}),e(D,{class:"my-2"}),e(b,{class:"pt-0"},{default:l(()=>a[4]||(a[4]=[t("div",{class:"text-caption text-grey"},"Busiest Day",-1),t("div",{class:"text-h6"},"Wednesday",-1)])),_:1})]),_:1})]),_:1})]),_:1}),e(d,{class:"mt-6",title:"Recent Visitor Log"},{append:l(()=>[e(k,{icon:"mdi-refresh",variant:"text",onClick:v,loading:c.value},null,8,["loading"])]),default:l(()=>[e(S,{headers:V,items:p.value,loading:c.value,class:"elevation-0"},{"item.checkInTime":l(({item:i})=>[o(w(new Date(i.checkInTime).toLocaleTimeString()),1)]),"item.status":l(({item:i})=>[e(g,{color:i.status==="Active"?"success":"default",size:"small"},{default:l(()=>[o(w(i.status),1)]),_:2},1032,["color"])]),"item.actions":l(({item:i})=>[i.status==="Active"?(h(),P(k,{key:0,size:"small",color:"warning",variant:"flat",onClick:I=>T(i),loading:m.value===i.id},{default:l(()=>a[5]||(a[5]=[o(" Check Out ")])),_:2},1032,["onClick","loading"])):A("",!0)]),_:1},8,["items","loading"])]),_:1}),a[7]||(a[7]=t("div",{class:"mt-4"},[t("p",null,[o("Public Visitor Link: "),t("a",{href:"/go/visitor-entry",target:"_blank"},"/go/visitor-entry")])],-1))]))}};export{N as default};
